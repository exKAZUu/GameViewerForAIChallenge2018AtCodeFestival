!function(e){var t={};function i(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(o,r,function(t){return e[t]}.bind(null,r));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=3)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Tile=class{constructor(e,t){this.row=e.row,this.col=e.col,this.value=t}savePosition(){this.previousPosition={row:this.row,col:this.col}}updatePosition(e){this.row=e.row,this.col=e.col}toString(){return this.value?Math.log2(this.value).toString(10):"0"}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(4),r=i(0),n=i(2);class s{constructor(e,t,i,r){this.nbRows=e,this.nbCols=t,this.board=i||new o.Board(this.nbRows,this.nbCols),this.actuator=r,this.actuate()}static GET_VECTOR(e){switch(e){case n.Direction.Up:return{x:0,y:-1};case n.Direction.Down:return{x:0,y:1};case n.Direction.Left:return{x:-1,y:0};case n.Direction.Right:return{x:1,y:0};default:return{x:0,y:0}}}static positionsEqual(e,t){return e.row===t.row&&e.col===t.col}move(e){const t=s.GET_VECTOR(e),i=this.buildTraversals(t);let o=!1;this.prepareTiles();let n=0,l=0;return i.row.forEach(e=>{i.col.forEach(i=>{const a={row:e,col:i},c=this.board.tileAt(a);if(c&&c.value){const e=this.findFarthestPosition(a,t),i=this.board.tileAt(e.next);if(i&&i.value===c.value&&!i.mergedFrom){const t=new r.Tile(e.next,2*c.value);t.mergedFrom=[c,i],this.board.insertTile(t),this.board.removeTile(c),c.updatePosition(e.next),n++,l+=2*c.value}else this.moveTile(c,e.farthest);s.positionsEqual(a,c)||(o=!0)}})}),o?(this.actuate(),{moved:!0,countMerged:n,scoreObtained:l}):{moved:!1,countMerged:0,scoreObtained:0}}actuate(){this.actuator&&this.actuator.actuate(this.board.tiles)}movesAvailable(){return this.board.getAvailableTiles().length>0||this.tileMatchesAvailable()}toString(){return this.board.toString()}prepareTiles(){this.board.eachTile((e,t,i)=>{i.value&&(i.mergedFrom=void 0,i.savePosition())})}setup(){this.board=new o.Board(this.nbRows,this.nbCols),this.actuate()}buildTraversals(e){const t={row:[],col:[]};for(let e=0;e<this.nbRows;e++)t.row.push(e);for(let e=0;e<this.nbCols;e++)t.col.push(e);return 1===e.x&&(t.col=t.col.reverse()),1===e.y&&(t.row=t.row.reverse()),t}tileMatchesAvailable(){for(let e=0;e<this.nbRows;e++)for(let t=0;t<this.nbCols;t++){const i=this.board.tileAt({row:e,col:t});if(i&&i.value){if(s.directions.some(o=>{const r=s.GET_VECTOR(o),n={row:e+r.y,col:t+r.x},l=this.board.tileAt(n);return!!l&&l.value===i.value}))return!0}}return!1}findFarthestPosition(e,t){let i,o=e;do{o={row:(i=o).row+t.y,col:i.col+t.x}}while(this.board.withinBounds(o)&&this.board.tileAvailable(o));return{farthest:i,next:o}}moveTile(e,t){this.board.removeTile(e),e.updatePosition(t),this.board.insertTile(e)}}s.directions=[n.Direction.Up,n.Direction.Down,n.Direction.Left,n.Direction.Right],t.BoardManager=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Up="UP",e.Down="DOWN",e.Left="LEFT",e.Right="RIGHT"}(t.Direction||(t.Direction={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(1),r=i(0),n=i(5),s=i(6),l=5,a=5,c=[];let u,d,h=[],f=800;function p(){u&&clearTimeout(u),c.forEach(e=>{e.setup()}),function e(t){if(h.length<=t)return void(u=void 0);d&&(d.innerText=String(Math.floor(t/2+1)));const i=h[t];if(i.aioutput){const e=i.aioutput.split(" ");if(t<2){const[i,o]=e.map(e=>parseInt(e,10)-1);c[(t+1)%2].board.insertTile(new r.Tile({row:i,col:o},2)),c[(t+1)%2].actuate()}else{const[i,...o]=e,r=n.GameManager.DIRECTIONS_MAP.get(i);r&&c[t%2].move(r),c[(t+1)%2].prepareTiles(),n.GameManager.PARSE_ATTACK_COMMAND(o,c[(t+1)%2].board).tiles.forEach(e=>{c[(t+1)%2].board.insertTile(e)}),c[(t+1)%2].actuate()}}u=window.setTimeout(()=>{e(t+1)},f)}(0)}function T(){const e=document.getElementById("file");if(!e||!e.files)return;const t=e.files[0],i=new FileReader;i.onload=(()=>{try{h=JSON.parse(i.result),p()}catch(e){alert("データの準備に失敗しました。"),console.log(e)}}),i.readAsText(t,"utf-8")}function v(e,t){const i=document.createElement(e);return i.setAttribute("class",t),i}window.addEventListener("load",()=>{["#frame1 .game-container","#frame2 .game-container"].forEach(e=>{const t=document.querySelector(e);if(t){const e=v("div","grid-container");for(let t=0;t<l;t++){const t=v("div","grid-row");for(let e=0;e<a;e++)t.appendChild(v("div","grid-cell"));e.appendChild(t)}t.appendChild(e);const i=v("div","tile-container");t.appendChild(i),c.push(new o.BoardManager(l,a,void 0,new s.HTMLActuator(i)))}}),function(){const e=document.getElementById("game-interval-slider");e&&(e.setAttribute("value",f.toString()),e.addEventListener("change",e=>{f=parseInt(e.target.value,10)}));const t=document.getElementById("file");console.log(t),t&&t.addEventListener("change",T);const i=document.getElementById("restart-button");i&&(i.onclick=T),(d=document.getElementById("turn"))&&(d.innerText="0")}()})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(0);class r{constructor(e,t){this.nbRows=e,this.nbCols=t,this.tiles=r.createEmptyTileBoard(this.nbRows,this.nbCols)}static FROM_STRINGS(e){const t=e.map(e=>e.trim().split(" ").map(e=>parseInt(e,10))),i=t.length,n=t[0].length,s=new r(i,n);for(let e=0;e<i;e++)for(let i=0;i<n;i++)t[e][i]>0&&s.insertTile(new o.Tile({row:e,col:i},Math.pow(2,t[e][i])));return s}static createEmptyTileBoard(e,t){const i=[];for(let r=0;r<e;r++){i[r]=[];for(let e=0;e<t;e++)i[r][e]=new o.Tile({row:r,col:e},void 0)}return i}withinBounds(e){return e.row>=0&&e.row<this.nbRows&&e.col>=0&&e.col<this.nbCols}insertTile(e){this.tiles[e.row][e.col]=e}removeTile(e){this.tiles[e.row][e.col]=new o.Tile({row:e.row,col:e.col},void 0)}tileAt(e){return this.withinBounds(e)&&this.tiles[e.row][e.col].value?this.tiles[e.row][e.col]:void 0}tileAvailable(e){return!this.tileOccupied(e)}getRandomAvailableTile(){const e=this.getAvailableTiles();if(e.length)return e[Math.floor(Math.random()*e.length)]}getAvailableTiles(){const e=[];return this.eachTile((t,i,r)=>{r.value||e.push(new o.Tile({row:t,col:i},void 0))}),e}eachTile(e){for(let t=0;t<this.nbRows;t++)for(let i=0;i<this.nbCols;i++)e(t,i,this.tiles[t][i])}tileOccupied(e){const t=this.tileAt(e);return t?!!t.value:void 0}toString(){return this.tiles.map(e=>e.map(e=>e.toString()).join(" ")).join("\n")}clone(){const e=new r(this.nbRows,this.nbCols);return this.eachTile((t,i,r)=>{r&&r.value&&r.value>0&&e.insertTile(new o.Tile({row:t,col:i},r.value))}),e}}t.Board=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(1),r=i(0),n=i(2);class s{constructor(e,t){this.ioLog=[],this.runners=[e,t]}static PARSE_ATTACK_COMMAND(e,t){if(!e.every(s.isPositiveInteger))return{verdict:"NG",reason:"PRESENTATION_ERROR",tiles:[]};const[i,...o]=e.map(e=>parseInt(e,10));if(3*i!==o.length)return{verdict:"NG",reason:"PRESENTATION_ERROR",tiles:[]};const n=[];for(let e=0;e<i;e++){const[i,s,l]=o.slice(3*e,3*e+3),a={row:i-1,col:s-1},c=Math.pow(2,l);if(t.tileOccupied(a))return{verdict:"NG",reason:"INVALID_POSITION",tiles:[]};n.push(new r.Tile(a,c))}return{verdict:"OK",tiles:n}}static isPositiveInteger(e){return s.POSITIVE_REGEXP.test(e)}async gameMain(){const e=[0,0];let t=0;const i=[0,0],n=[new o.BoardManager(s.BOARD_NUM_ROWS,s.BOARD_NUM_COLS),new o.BoardManager(s.BOARD_NUM_ROWS,s.BOARD_NUM_COLS)],l=(o,r)=>({winner:0===o?"FIRST":"SECOND",reason:r,turn:t,stats:{first:{time:e[0],score:i[0]},second:{time:e[1],score:i[1]}}});for(let t=0;t<2;t++){const i=this.runners[t],o={commands:[t.toString(10)]},a=await i.sendAndReceiveData(o,s.INTIALIZE_TIME_MS);if(console.log(a),this.ioLog.push([o,a]),e[t]+=a.runtimeNs,"OK"!==a.verdict)return"TLE"===a.verdict?l((t+1)%2,"TIME_LIMIT_EXCEEDED"):l((t+1)%2,"RUNTIME_ERROR");const c=(()=>{if(!a.output)return"PRESENTATION_ERROR";const e=a.output.split(" ");if(!e.every(s.isPositiveInteger))return"PRESENTATION_ERROR";const[i,o]=e.map(e=>parseInt(e,10)-1);return n[t].board.withinBounds({row:i,col:o})?(n[(t+1)%2].board.insertTile(new r.Tile({row:i,col:o},2)),null):"INVALID_POSITION"})();if(c)return l((t+1)%2,c)}for(t=1;t<=s.MAX_TURN;t++)for(let t=0;t<2;t++){const o=this.runners[t],r=n[t],a=n[(t+1)%2];if(!r.movesAvailable())return l((t+1)%2,"BOARD_FILLED");const c={commands:[r.toString(),a.toString()]},u=await o.sendAndReceiveData(c,s.MAIN_TURN_TIME_MS);if(console.log(u),this.ioLog.push([c,u]),e[t]+=u.runtimeNs,"OK"!==u.verdict)return"TLE"===u.verdict?l((t+1)%2,"TIME_LIMIT_EXCEEDED"):l((t+1)%2,"RUNTIME_ERROR");const d=(()=>{if(!u.output)return"PRESENTATION_ERROR";const[e,...o]=u.output.split(" ");if(!e)return"PRESENTATION_ERROR";const n=s.DIRECTIONS_MAP.get(e);if(!n)return"INVALID_DIRECTION";const l=r.move(n);if(!l.moved)return"INVALID_DIRECTION";const c=s.PARSE_ATTACK_COMMAND(o,a.board);if("OK"!==c.verdict)return!1;let d=0;return c.tiles.forEach(e=>{a.board.insertTile(e),d+=e.value||0}),d!==Math.pow(2,l.countMerged+1)?"INVALID_VALUE_TO_PUT":(i[t]+=l.scoreObtained,null)})();if(d)return l((t+1)%2,d)}return i[0]>i[1]?l(0,"SCORE"):i[1]>i[0]?l(1,"SCORE"):l(1,"EVEN_SCORE")}writeLogsToFile(e){0}}s.DIRECTIONS_MAP=new Map([["U",n.Direction.Up],["D",n.Direction.Down],["R",n.Direction.Right],["L",n.Direction.Left]]),s.BOARD_NUM_ROWS=5,s.BOARD_NUM_COLS=5,s.INTIALIZE_TIME_MS=500,s.MAIN_TURN_TIME_MS=100,s.MAX_TURN=1e3,s.POSITIVE_REGEXP=/^\+0|[1-9]\d*$/,t.GameManager=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HTMLActuator=class{constructor(e){this.tileContainer=e}actuate(e){window.requestAnimationFrame(()=>{this.clearContainer(this.tileContainer),e.forEach(e=>{e.forEach(e=>{e&&this.addTile(e)})})})}clearContainer(e){for(;e.firstChild;)e.removeChild(e.firstChild)}addTile(e){if(!e.value)return;const t=document.createElement("div"),i=document.createElement("div"),o=e.previousPosition||{row:e.row,col:e.col},r=this.positionClass(o),n=["tile",`tile-${e.value}`,r];e.value>2048&&n.push("tile-super"),this.applyClasses(t,n),i.classList.add("tile-inner"),i.textContent=e.value.toString(10),e.previousPosition?window.requestAnimationFrame(()=>{n[2]=this.positionClass({row:e.row,col:e.col}),this.applyClasses(t,n)}):e.mergedFrom?(n.push("tile-merged"),this.applyClasses(t,n),e.mergedFrom.forEach(e=>{this.addTile(e)})):(n.push("tile-new"),this.applyClasses(t,n)),t.appendChild(i),this.tileContainer.appendChild(t)}positionClass(e){return`tile-position-${e.col+1}-${e.row+1}`}applyClasses(e,t){e.setAttribute("class",t.join(" "))}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4uL2dhbWUvc3JjL0NvcmUvVGlsZS50cyIsIndlYnBhY2s6Ly8vLi4vZ2FtZS9zcmMvQ29yZS9Cb2FyZE1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vLy4uL2dhbWUvc3JjL0NvcmUvdHlwZXMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vLy4uL2dhbWUvc3JjL0NvcmUvQm9hcmQudHMiLCJ3ZWJwYWNrOi8vLy4uL2dhbWUvc3JjL0dhbWVNYW5hZ2VyLnRzIiwid2VicGFjazovLy8uL3NyYy9IVE1MQWN0dWF0b3IudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJUaWxlIiwiW29iamVjdCBPYmplY3RdIiwicG9zaXRpb24iLCJpbml0aWFsVmFsdWUiLCJ0aGlzIiwicm93IiwiY29sIiwicHJldmlvdXNQb3NpdGlvbiIsIk1hdGgiLCJsb2cyIiwidG9TdHJpbmciLCJCb2FyZF8xIiwiVGlsZV8xIiwidHlwZXNfMSIsIkJvYXJkTWFuYWdlciIsInJvd3MiLCJjb2xzIiwiYm9hcmQiLCJhY3R1YXRvciIsIm5iUm93cyIsIm5iQ29scyIsIkJvYXJkIiwiYWN0dWF0ZSIsImRpcmVjdGlvbiIsIkRpcmVjdGlvbiIsIlVwIiwieCIsInkiLCJEb3duIiwiTGVmdCIsIlJpZ2h0IiwiZmlyc3QiLCJzZWNvbmQiLCJ2ZWN0b3IiLCJHRVRfVkVDVE9SIiwidHJhdmVyc2FscyIsImJ1aWxkVHJhdmVyc2FscyIsIm1vdmVkIiwicHJlcGFyZVRpbGVzIiwiY291bnRNZXJnZWQiLCJzY29yZSIsImZvckVhY2giLCJ0aWxlUG9zaXRpb24iLCJ0aWxlIiwidGlsZUF0IiwicG9zaXRpb25zIiwiZmluZEZhcnRoZXN0UG9zaXRpb24iLCJuZXh0IiwibWVyZ2VkRnJvbSIsIm1lcmdlZCIsImluc2VydFRpbGUiLCJyZW1vdmVUaWxlIiwidXBkYXRlUG9zaXRpb24iLCJtb3ZlVGlsZSIsImZhcnRoZXN0IiwicG9zaXRpb25zRXF1YWwiLCJzY29yZU9idGFpbmVkIiwidGlsZXMiLCJnZXRBdmFpbGFibGVUaWxlcyIsImxlbmd0aCIsInRpbGVNYXRjaGVzQXZhaWxhYmxlIiwiZWFjaFRpbGUiLCJ1bmRlZmluZWQiLCJzYXZlUG9zaXRpb24iLCJwdXNoIiwiaiIsInJldmVyc2UiLCJkaXJlY3Rpb25zIiwic29tZSIsIm90aGVyVGlsZSIsInByZXZpb3VzIiwiY3VycmVudCIsIndpdGhpbkJvdW5kcyIsInRpbGVBdmFpbGFibGUiLCJCb2FyZE1hbmFnZXJfMSIsIkdhbWVNYW5hZ2VyXzEiLCJIVE1MQWN0dWF0b3JfMSIsIm5Sb3ciLCJuQ29sIiwiYm1zIiwidGltZXJJZCIsInR1cm5UZXh0IiwiY29tbWFuZHMiLCJnYW1lSW50ZXJ2YWwiLCJzdGFydEFuaW1hdGlvbiIsImNsZWFyVGltZW91dCIsImJtIiwic2V0dXAiLCJ0aW1lclRhc2siLCJ0dXJuIiwiaW5uZXJUZXh0IiwiU3RyaW5nIiwiZmxvb3IiLCJvYmoiLCJhaW91dHB1dCIsImNvbW1hbmQiLCJzcGxpdCIsIm1hcCIsInYiLCJwYXJzZUludCIsImRpckNvbW1hbmQiLCJhdHRhY2siLCJkaXIiLCJHYW1lTWFuYWdlciIsIkRJUkVDVElPTlNfTUFQIiwibW92ZSIsIlBBUlNFX0FUVEFDS19DT01NQU5EIiwid2luZG93Iiwic2V0VGltZW91dCIsImxvYWRGaWxlIiwiaW5wdXRFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImZpbGVzIiwiZmlsZSIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJKU09OIiwicGFyc2UiLCJyZXN1bHQiLCJlIiwiYWxlcnQiLCJjb25zb2xlIiwibG9nIiwicmVhZEFzVGV4dCIsImNyZWF0ZUVsZW1lbnRXaXRoQ2xhc3MiLCJ0YWdOYW1lIiwiY2xhc3NOYW1lIiwiZWxlbSIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJhZGRFdmVudExpc3RlbmVyIiwiZnJhbWVRdWVyeSIsImdhbWVDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwiZ3JpZENvbnRhaW5lciIsImdyaWRSb3ciLCJhcHBlbmRDaGlsZCIsInRpbGVDb250YWluZXIiLCJIVE1MQWN0dWF0b3IiLCJzbGlkZXIiLCJldmVudCIsInRhcmdldCIsImlucHV0IiwicmVzdGFydCIsIm9uY2xpY2siLCJwcmVwYXJlQnV0dG9ucyIsImNyZWF0ZUVtcHR5VGlsZUJvYXJkIiwic3RyaW5ncyIsIm51bWJlcnMiLCJzdHIiLCJ0cmltIiwiblJvd3MiLCJuQ29scyIsInBvdyIsInRpbGVPY2N1cGllZCIsImF2YWlsYWJsZVRpbGVzIiwicmFuZG9tIiwiY2FsbGJhY2siLCJqb2luIiwiZmlyc3RQbGF5ZXIiLCJzZWNvbmRQbGF5ZXIiLCJpb0xvZyIsInJ1bm5lcnMiLCJlbmVteUJvYXJkIiwiZXZlcnkiLCJpc1Bvc2l0aXZlSW50ZWdlciIsInZlcmRpY3QiLCJyZWFzb24iLCJNIiwidmVjIiwicFZhbCIsInNsaWNlIiwiUE9TSVRJVkVfUkVHRVhQIiwidGVzdCIsImNvbnN1bWVkVGltZXNOcyIsInNjb3JlcyIsImJvYXJkcyIsIkJPQVJEX05VTV9ST1dTIiwiQk9BUkRfTlVNX0NPTFMiLCJidWlsZFJlc3VsdCIsIndpbm5lciIsInN0YXRzIiwidGltZSIsInBsYXllciIsInJ1bm5lciIsInJldCIsInNlbmRBbmRSZWNlaXZlRGF0YSIsIklOVElBTElaRV9USU1FX01TIiwicnVudGltZU5zIiwib3V0cHV0IiwiaW5pdGlhbFRpbGUiLCJNQVhfVFVSTiIsIm15Qm9hcmQiLCJtb3Zlc0F2YWlsYWJsZSIsIk1BSU5fVFVSTl9USU1FX01TIiwibW92ZWRSZXN1bHQiLCJwYXJzZWQiLCJ1c2VkVmFsdWUiLCJmaWxlTmFtZSIsIk1hcCIsImdyaWQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjbGVhckNvbnRhaW5lciIsImNvbHVtbiIsImNlbGwiLCJhZGRUaWxlIiwiY29udGFpbmVyIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwid3JhcHBlciIsImlubmVyIiwicG9zaXRpb25DbGFzcyIsImNsYXNzZXMiLCJhcHBseUNsYXNzZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsImVsZW1lbnQiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsYUFBd0RDLE1BQUEsV0FFeERQLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURtQixPQUFBLEtBUWpEckIsRUFBQXNCLEVBQUEsU0FBQUQsRUFBQUUsR0FFQSxHQURBLEVBQUFBLElBQUFGLEVBQUFyQixFQUFBcUIsSUFDQSxFQUFBRSxFQUFBLE9BQUFGLEVBQ0EsS0FBQUUsR0FBQSxpQkFBQUYsUUFBQUcsV0FBQSxPQUFBSCxFQUNBLElBQUFJLEVBQUFYLE9BQUFZLE9BQUEsTUFHQSxHQUZBMUIsRUFBQWtCLEVBQUFPLEdBQ0FYLE9BQUFDLGVBQUFVLEVBQUEsV0FBeUNULFlBQUEsRUFBQUssVUFDekMsRUFBQUUsR0FBQSxpQkFBQUYsRUFBQSxRQUFBTSxLQUFBTixFQUFBckIsRUFBQVUsRUFBQWUsRUFBQUUsRUFBQSxTQUFBQSxHQUFnSCxPQUFBTixFQUFBTSxJQUFxQkMsS0FBQSxLQUFBRCxJQUNySSxPQUFBRixHQUlBekIsRUFBQTZCLEVBQUEsU0FBQTFCLEdBQ0EsSUFBQVMsRUFBQVQsS0FBQXFCLFdBQ0EsV0FBMkIsT0FBQXJCLEVBQUEsU0FDM0IsV0FBaUMsT0FBQUEsR0FFakMsT0FEQUgsRUFBQVUsRUFBQUUsRUFBQSxJQUFBQSxHQUNBQSxHQUlBWixFQUFBYSxFQUFBLFNBQUFpQixFQUFBQyxHQUFzRCxPQUFBakIsT0FBQWtCLFVBQUFDLGVBQUExQixLQUFBdUIsRUFBQUMsSUFHdEQvQixFQUFBa0MsRUFBQSxHQUlBbEMsSUFBQW1DLEVBQUEsbUZDaEZBakMsRUFBQWtDLFdBT0VDLFlBQVlDLEVBQW9CQyxHQUM5QkMsS0FBS0MsSUFBTUgsRUFBU0csSUFDcEJELEtBQUtFLElBQU1KLEVBQVNJLElBQ3BCRixLQUFLbkIsTUFBUWtCLEVBR1JGLGVBQ0xHLEtBQUtHLGtCQUFxQkYsSUFBS0QsS0FBS0MsSUFBS0MsSUFBS0YsS0FBS0UsS0FHOUNMLGVBQWVDLEdBQ3BCRSxLQUFLQyxJQUFNSCxFQUFTRyxJQUNwQkQsS0FBS0UsSUFBTUosRUFBU0ksSUFHZkwsV0FDTCxPQUFJRyxLQUFLbkIsTUFDQXVCLEtBQUtDLEtBQUtMLEtBQUtuQixPQUFPeUIsU0FBUyxJQUUvQixxRkMzQmIsTUFBQUMsRUFBQS9DLEVBQUEsR0FDQWdELEVBQUFoRCxFQUFBLEdBQ0FpRCxFQUFBakQsRUFBQSxTQUVha0QsRUFPWGIsWUFBWWMsRUFBY0MsRUFBY0MsRUFBZUMsR0FDckRkLEtBQUtlLE9BQVNKLEVBQ2RYLEtBQUtnQixPQUFTSixFQUtaWixLQUFLYSxNQUhGQSxHQUNVLElBQUlOLEVBQUFVLE1BQU1qQixLQUFLZSxPQUFRZixLQUFLZ0IsUUFLM0NoQixLQUFLYyxTQUFXQSxFQUNoQmQsS0FBS2tCLFVBR0FyQixrQkFBa0JzQixHQUN2QixPQUFRQSxHQUNOLEtBQUtWLEVBQUFXLFVBQVVDLEdBQ2IsT0FBU0MsRUFBRyxFQUFHQyxHQUFJLEdBRXJCLEtBQUtkLEVBQUFXLFVBQVVJLEtBQ2IsT0FBU0YsRUFBRyxFQUFHQyxFQUFHLEdBRXBCLEtBQUtkLEVBQUFXLFVBQVVLLEtBQ2IsT0FBU0gsR0FBSSxFQUFHQyxFQUFHLEdBRXJCLEtBQUtkLEVBQUFXLFVBQVVNLE1BQ2IsT0FBU0osRUFBRyxFQUFHQyxFQUFHLEdBRXBCLFFBQ0UsT0FBU0QsRUFBRyxFQUFHQyxFQUFHLElBS2hCMUIsc0JBQXNCOEIsRUFBaUJDLEdBQzdDLE9BQU9ELEVBQU0xQixNQUFRMkIsRUFBTzNCLEtBQU8wQixFQUFNekIsTUFBUTBCLEVBQU8xQixJQUduREwsS0FBS3NCLEdBQ1YsTUFBTVUsRUFBU25CLEVBQWFvQixXQUFXWCxHQUNqQ1ksRUFBYS9CLEtBQUtnQyxnQkFBZ0JILEdBQ3hDLElBQUlJLEdBQVEsRUFFWmpDLEtBQUtrQyxlQUVMLElBQUlDLEVBQWMsRUFDZEMsRUFBUSxFQWdDWixPQS9CQUwsRUFBVzlCLElBQUlvQyxRQUFRcEMsSUFDckI4QixFQUFXN0IsSUFBSW1DLFFBQVFuQyxJQUNyQixNQUFNb0MsR0FBaUJyQyxJQUFLQSxFQUFLQyxJQUFLQSxHQUNoQ3FDLEVBQU92QyxLQUFLYSxNQUFNMkIsT0FBT0YsR0FFL0IsR0FBSUMsR0FBUUEsRUFBSzFELE1BQU8sQ0FDdEIsTUFBTTRELEVBQVl6QyxLQUFLMEMscUJBQXFCSixFQUFjVCxHQUNwRGMsRUFBTzNDLEtBQUthLE1BQU0yQixPQUFPQyxFQUFVRSxNQUV6QyxHQUFJQSxHQUFRQSxFQUFLOUQsUUFBVTBELEVBQUsxRCxRQUFVOEQsRUFBS0MsV0FBWSxDQUN6RCxNQUFNQyxFQUFTLElBQUlyQyxFQUFBWixLQUFLNkMsRUFBVUUsS0FBbUIsRUFBYkosRUFBSzFELE9BQzdDZ0UsRUFBT0QsWUFBY0wsRUFBTUksR0FFM0IzQyxLQUFLYSxNQUFNaUMsV0FBV0QsR0FDdEI3QyxLQUFLYSxNQUFNa0MsV0FBV1IsR0FFdEJBLEVBQUtTLGVBQWVQLEVBQVVFLE1BRTlCUixJQUNBQyxHQUFzQixFQUFiRyxFQUFLMUQsV0FFZG1CLEtBQUtpRCxTQUFTVixFQUFNRSxFQUFVUyxVQUczQnhDLEVBQWF5QyxlQUFlYixFQUFjQyxLQUM3Q04sR0FBUSxRQU1aQSxHQUNGakMsS0FBS2tCLFdBRUhlLE9BQU8sRUFDUEUsY0FDQWlCLGNBQWVoQixLQUtqQkgsT0FBTyxFQUNQRSxZQUFhLEVBQ2JpQixjQUFlLEdBSVp2RCxVQUNERyxLQUFLYyxVQUNQZCxLQUFLYyxTQUFTSSxRQUFRbEIsS0FBS2EsTUFBTXdDLE9BSTlCeEQsaUJBQ0wsT0FBT0csS0FBS2EsTUFBTXlDLG9CQUFvQkMsT0FBUyxHQUFLdkQsS0FBS3dELHVCQUdwRDNELFdBQ0wsT0FBT0csS0FBS2EsTUFBTVAsV0FHYlQsZUFDTEcsS0FBS2EsTUFBTTRDLFNBQVMsQ0FBQ25DLEVBQVdDLEVBQVdnQixLQUNyQ0EsRUFBSzFELFFBQ1AwRCxFQUFLSyxnQkFBYWMsRUFDbEJuQixFQUFLb0Isa0JBS0o5RCxRQUNMRyxLQUFLYSxNQUFRLElBQUlOLEVBQUFVLE1BQU1qQixLQUFLZSxPQUFRZixLQUFLZ0IsUUFDekNoQixLQUFLa0IsVUFHQXJCLGdCQUFnQmdDLEdBQ3JCLE1BQU1FLEdBQWlEOUIsT0FBU0MsUUFFaEUsSUFBSyxJQUFJdEMsRUFBSSxFQUFHQSxFQUFJb0MsS0FBS2UsT0FBUW5ELElBQy9CbUUsRUFBVzlCLElBQUkyRCxLQUFLaEcsR0FFdEIsSUFBSyxJQUFJaUcsRUFBSSxFQUFHQSxFQUFJN0QsS0FBS2dCLE9BQVE2QyxJQUMvQjlCLEVBQVc3QixJQUFJMEQsS0FBS0MsR0FTdEIsT0FQaUIsSUFBYmhDLEVBQU9QLElBQ1RTLEVBQVc3QixJQUFNNkIsRUFBVzdCLElBQUk0RCxXQUVqQixJQUFiakMsRUFBT04sSUFDVFEsRUFBVzlCLElBQU04QixFQUFXOUIsSUFBSTZELFdBRzNCL0IsRUFHRGxDLHVCQUNOLElBQUssSUFBSWpDLEVBQUksRUFBR0EsRUFBSW9DLEtBQUtlLE9BQVFuRCxJQUMvQixJQUFLLElBQUlpRyxFQUFJLEVBQUdBLEVBQUk3RCxLQUFLZ0IsT0FBUTZDLElBQUssQ0FDcEMsTUFBTXRCLEVBQU92QyxLQUFLYSxNQUFNMkIsUUFBU3ZDLElBQUtyQyxFQUFHc0MsSUFBSzJELElBRTlDLEdBQUl0QixHQUFRQSxFQUFLMUQsTUFBTyxDQVN0QixHQVJnQjZCLEVBQWFxRCxXQUFXQyxLQUNyQzdDLElBQ0MsTUFBTVUsRUFBU25CLEVBQWFvQixXQUFXWCxHQUNqQ21CLEdBQWlCckMsSUFBS3JDLEVBQUlpRSxFQUFPTixFQUFHckIsSUFBSzJELEVBQUloQyxFQUFPUCxHQUNwRDJDLEVBQVlqRSxLQUFLYSxNQUFNMkIsT0FBT0YsR0FDcEMsUUFBUzJCLEdBQWFBLEVBQVVwRixRQUFVMEQsRUFBSzFELFFBSWpELE9BQU8sR0FLZixPQUFPLEVBR0RnQixxQkFBcUJ5QyxFQUF3QlQsR0FDbkQsSUFBSXFDLEVBQ0FDLEVBQVU3QixFQUNkLEdBRUU2QixHQUFZbEUsS0FEWmlFLEVBQVdDLEdBQ2VsRSxJQUFNNEIsRUFBT04sRUFBR3JCLElBQUtnRSxFQUFTaEUsSUFBTTJCLEVBQU9QLFNBQzlEdEIsS0FBS2EsTUFBTXVELGFBQWFELElBQVluRSxLQUFLYSxNQUFNd0QsY0FBY0YsSUFFdEUsT0FDRWpCLFNBQVVnQixFQUNWdkIsS0FBTXdCLEdBSUZ0RSxTQUFTMEMsRUFBWXpDLEdBQzNCRSxLQUFLYSxNQUFNa0MsV0FBV1IsR0FDdEJBLEVBQUtTLGVBQWVsRCxHQUNwQkUsS0FBS2EsTUFBTWlDLFdBQVdQLElBM0xBN0IsRUFBQXFELFlBQWN0RCxFQUFBVyxVQUFVQyxHQUFJWixFQUFBVyxVQUFVSSxLQUFNZixFQUFBVyxVQUFVSyxLQUFNaEIsRUFBQVcsVUFBVU0sT0FEaEdoRSxFQUFBZ0QsOEZDRkEsU0FBWVUsR0FDVkEsRUFBQSxRQUNBQSxFQUFBLFlBQ0FBLEVBQUEsWUFDQUEsRUFBQSxjQUpGLENBQVkxRCxFQUFBMEQsWUFBQTFELEVBQUEwRCw4RkNIWixNQUFBa0QsRUFBQTlHLEVBQUEsR0FDQWdELEVBQUFoRCxFQUFBLEdBQ0ErRyxFQUFBL0csRUFBQSxHQUVBZ0gsRUFBQWhILEVBQUEsR0FFTWlILEVBQU8sRUFDUEMsRUFBTyxFQUVQQyxLQUNOLElBR0lDLEVBRUFDLEVBTEFDLEtBRUFDLEVBQWUsSUFpRG5CLFNBQVNDLElBQ0hKLEdBQ0ZLLGFBQWFMLEdBSWZELEVBQUl0QyxRQUFRNkMsSUFDVkEsRUFBR0MsVUFuRFAsU0FBU0MsRUFBVUMsR0FDakIsR0FBSVAsRUFBU3ZCLFFBQVU4QixFQUVyQixZQURBVCxPQUFVbEIsR0FJUm1CLElBQ0ZBLEVBQVNTLFVBQVlDLE9BQU9uRixLQUFLb0YsTUFBTUgsRUFBTyxFQUFJLEtBR3BELE1BQU1JLEVBQU1YLEVBQVNPLEdBQ3JCLEdBQUlJLEVBQUlDLFNBQVUsQ0FDaEIsTUFBTUMsRUFBVUYsRUFBSUMsU0FBU0UsTUFBTSxLQUNuQyxHQUFJUCxFQUFPLEVBQUcsQ0FFWixNQUFPcEYsRUFBS0MsR0FBT3lGLEVBQVFFLElBQUlDLEdBQ3RCQyxTQUFTRCxFQUFHLElBQU0sR0FFM0JuQixHQUFLVSxFQUFPLEdBQUssR0FBR3hFLE1BQU1pQyxXQUFXLElBQUl0QyxFQUFBWixNQUFPSyxNQUFLQyxPQUFPLElBQzVEeUUsR0FBS1UsRUFBTyxHQUFLLEdBQUduRSxjQUNmLENBQ0wsTUFBTzhFLEtBQWVDLEdBQVVOLEVBRzFCTyxFQUFNM0IsRUFBQTRCLFlBQVlDLGVBQWUzSCxJQUFJdUgsR0FDdkNFLEdBQ0Z2QixFQUFJVSxFQUFPLEdBQUdnQixLQUFLSCxHQUlyQnZCLEdBQUtVLEVBQU8sR0FBSyxHQUFHbkQsZUFDTHFDLEVBQUE0QixZQUFZRyxxQkFBcUJMLEVBQVF0QixHQUFLVSxFQUFPLEdBQUssR0FBR3hFLE9BQ3JFd0MsTUFBTWhCLFFBQVFFLElBQ25Cb0MsR0FBS1UsRUFBTyxHQUFLLEdBQUd4RSxNQUFNaUMsV0FBV1AsS0FFdkNvQyxHQUFLVSxFQUFPLEdBQUssR0FBR25FLFdBSXhCMEQsRUFBVTJCLE9BQU9DLFdBQVcsS0FDMUJwQixFQUFVQyxFQUFPLElBQ2hCTixHQWFISyxDQUFVLEdBR1osU0FBU3FCLElBQ1AsTUFBTUMsRUFBaUNDLFNBQVNDLGVBQWUsUUFDL0QsSUFBS0YsSUFBaUJBLEVBQWFHLE1BQ2pDLE9BR0YsTUFBTUMsRUFBT0osRUFBYUcsTUFBTSxHQUMxQkUsRUFBUyxJQUFJQyxXQUVuQkQsRUFBT0UsT0FBUyxNQUNkLElBQ0VuQyxFQUFXb0MsS0FBS0MsTUFBY0osRUFBT0ssUUFDckNwQyxJQUNBLE1BQU9xQyxHQUNQQyxNQUFNLGtCQUNOQyxRQUFRQyxJQUFJSCxNQUdoQk4sRUFBT1UsV0FBV1gsRUFBTSxTQTBCMUIsU0FBU1ksRUFBdUJDLEVBQWlCQyxHQUMvQyxNQUFNQyxFQUFPbEIsU0FBU21CLGNBQWNILEdBRXBDLE9BREFFLEVBQUtFLGFBQWEsUUFBU0gsR0FDcEJDLEVBNkJUdEIsT0FBT3lCLGlCQUFpQixPQUFRLE1BdEQ3QiwwQkFBMkIsMkJBQTJCM0YsUUFBUTRGLElBQzdELE1BQU1DLEVBQWdCdkIsU0FBU3dCLGNBQWNGLEdBQzdDLEdBQUlDLEVBQWUsQ0FDakIsTUFBTUUsRUFBZ0JWLEVBQXVCLE1BQU8sa0JBRXBELElBQUssSUFBSXpILEVBQU0sRUFBR0EsRUFBTXdFLEVBQU14RSxJQUFPLENBQ25DLE1BQU1vSSxFQUFVWCxFQUF1QixNQUFPLFlBQzlDLElBQUssSUFBSXhILEVBQU0sRUFBR0EsRUFBTXdFLEVBQU14RSxJQUM1Qm1JLEVBQVFDLFlBQVlaLEVBQXVCLE1BQU8sY0FFcERVLEVBQWNFLFlBQVlELEdBRTVCSCxFQUFjSSxZQUFZRixHQUUxQixNQUFNRyxFQUFnQmIsRUFBdUIsTUFBTyxrQkFDcERRLEVBQWNJLFlBQVlDLEdBRTFCNUQsRUFBSWYsS0FBSyxJQUFJVSxFQUFBNUQsYUFBYStELEVBQU1DLE9BQU1oQixFQUFXLElBQUljLEVBQUFnRSxhQUFhRCxRQVd4RSxXQUNFLE1BQU1FLEVBQVM5QixTQUFTQyxlQUFlLHdCQUNuQzZCLElBQ0ZBLEVBQU9WLGFBQWEsUUFBU2hELEVBQWF6RSxZQUMxQ21JLEVBQU9ULGlCQUFpQixTQUFVVSxJQUNoQzNELEVBQWVnQixTQUE0QjJDLEVBQU1DLE9BQVE5SixNQUFPLE9BSXBFLE1BQU0rSixFQUFRakMsU0FBU0MsZUFBZSxRQUN0Q1csUUFBUUMsSUFBSW9CLEdBQ1JBLEdBQ0ZBLEVBQU1aLGlCQUFpQixTQUFVdkIsR0FHbkMsTUFBTW9DLEVBQVVsQyxTQUFTQyxlQUFlLGtCQUNwQ2lDLElBQ0ZBLEVBQVFDLFFBQVVyQyxJQUdwQjVCLEVBQVc4QixTQUFTQyxlQUFlLFdBRWpDL0IsRUFBU1MsVUFBWSxLQU12QnlELG9GQ3hKRixNQUFBdkksRUFBQWhELEVBQUEsU0FHYXlELEVBTVhwQixZQUFZYyxFQUFjQyxHQUN4QlosS0FBS2UsT0FBU0osRUFDZFgsS0FBS2dCLE9BQVNKLEVBQ2RaLEtBQUtxRCxNQUFRcEMsRUFBTStILHFCQUFxQmhKLEtBQUtlLE9BQVFmLEtBQUtnQixRQUdyRG5CLG9CQUFvQm9KLEdBRXpCLE1BQU1DLEVBQVVELEVBQVFwRCxJQUFJc0QsR0FDMUJBLEVBQ0dDLE9BQ0F4RCxNQUFNLEtBQ05DLElBQUlDLEdBQUtDLFNBQVNELEVBQUcsTUFFcEJ1RCxFQUFRSCxFQUFRM0YsT0FDaEIrRixFQUFRSixFQUFRLEdBQUczRixPQUNuQjFDLEVBQVEsSUFBSUksRUFBTW9JLEVBQU9DLEdBRS9CLElBQUssSUFBSXJKLEVBQU0sRUFBR0EsRUFBTW9KLEVBQU9wSixJQUM3QixJQUFLLElBQUlDLEVBQU0sRUFBR0EsRUFBTW9KLEVBQU9wSixJQUN6QmdKLEVBQVFqSixHQUFLQyxHQUFPLEdBQ3RCVyxFQUFNaUMsV0FBVyxJQUFJdEMsRUFBQVosTUFBT0ssTUFBS0MsT0FBT0UsS0FBS21KLElBQUksRUFBR0wsRUFBUWpKLEdBQUtDLE1BSXZFLE9BQU9XLEVBR0RoQiw0QkFBNEJrQixFQUFnQkMsR0FDbEQsTUFBTXFDLEtBRU4sSUFBSyxJQUFJekYsRUFBSSxFQUFHQSxFQUFJbUQsRUFBUW5ELElBQUssQ0FDL0J5RixFQUFNekYsTUFDTixJQUFLLElBQUlpRyxFQUFJLEVBQUdBLEVBQUk3QyxFQUFRNkMsSUFDMUJSLEVBQU16RixHQUFHaUcsR0FBSyxJQUFJckQsRUFBQVosTUFBT0ssSUFBS3JDLEVBQUdzQyxJQUFLMkQsUUFBS0gsR0FHL0MsT0FBT0wsRUFHRnhELGFBQWFDLEdBQ2xCLE9BQU9BLEVBQVNHLEtBQU8sR0FBS0gsRUFBU0csSUFBTUQsS0FBS2UsUUFBVWpCLEVBQVNJLEtBQU8sR0FBS0osRUFBU0ksSUFBTUYsS0FBS2dCLE9BRzlGbkIsV0FBVzBDLEdBQ2hCdkMsS0FBS3FELE1BQU1kLEVBQUt0QyxLQUFLc0MsRUFBS3JDLEtBQU9xQyxFQUc1QjFDLFdBQVcwQyxHQUNoQnZDLEtBQUtxRCxNQUFNZCxFQUFLdEMsS0FBS3NDLEVBQUtyQyxLQUFPLElBQUlNLEVBQUFaLE1BQU9LLElBQUtzQyxFQUFLdEMsSUFBS0MsSUFBS3FDLEVBQUtyQyxVQUFPd0QsR0FHdkU3RCxPQUFPQyxHQUNaLE9BQUlFLEtBQUtvRSxhQUFhdEUsSUFBYUUsS0FBS3FELE1BQU12RCxFQUFTRyxLQUFLSCxFQUFTSSxLQUFLckIsTUFDakVtQixLQUFLcUQsTUFBTXZELEVBQVNHLEtBQUtILEVBQVNJLFVBRXpDLEVBSUdMLGNBQWNDLEdBQ25CLE9BQVFFLEtBQUt3SixhQUFhMUosR0FHckJELHlCQUNMLE1BQU00SixFQUFpQnpKLEtBQUtzRCxvQkFDNUIsR0FBSW1HLEVBQWVsRyxPQUNqQixPQUFPa0csRUFBZXJKLEtBQUtvRixNQUFNcEYsS0FBS3NKLFNBQVdELEVBQWVsRyxTQUk3RDFELG9CQUNMLE1BQU00SixLQU1OLE9BTEF6SixLQUFLeUQsU0FBUyxDQUFDeEQsRUFBYUMsRUFBYXFDLEtBQ2xDQSxFQUFLMUQsT0FDUjRLLEVBQWU3RixLQUFLLElBQUlwRCxFQUFBWixNQUFPSyxNQUFLQyxZQUFPd0QsTUFHeEMrRixFQUdGNUosU0FBUzhKLEdBQ2QsSUFBSyxJQUFJL0wsRUFBSSxFQUFHQSxFQUFJb0MsS0FBS2UsT0FBUW5ELElBQy9CLElBQUssSUFBSWlHLEVBQUksRUFBR0EsRUFBSTdELEtBQUtnQixPQUFRNkMsSUFDL0I4RixFQUFTL0wsRUFBR2lHLEVBQUc3RCxLQUFLcUQsTUFBTXpGLEdBQUdpRyxJQUs1QmhFLGFBQWFDLEdBQ2xCLE1BQU15QyxFQUFPdkMsS0FBS3dDLE9BQU8xQyxHQUN6QixPQUFJeUMsSUFDT0EsRUFBSzFELFdBRWQsRUFJR2dCLFdBQ0wsT0FBT0csS0FBS3FELE1BQU13QyxJQUFJNUYsR0FBT0EsRUFBSTRGLElBQUl0RCxHQUFRQSxFQUFLakMsWUFBWXNKLEtBQUssTUFBTUEsS0FBSyxNQUd6RS9KLFFBQ0wsTUFBTXVILEVBQVMsSUFBSW5HLEVBQU1qQixLQUFLZSxPQUFRZixLQUFLZ0IsUUFNM0MsT0FMQWhCLEtBQUt5RCxTQUFTLENBQUN4RCxFQUFLQyxFQUFLcUMsS0FDbkJBLEdBQVFBLEVBQUsxRCxPQUFTMEQsRUFBSzFELE1BQVEsR0FDckN1SSxFQUFPdEUsV0FBVyxJQUFJdEMsRUFBQVosTUFBT0ssTUFBS0MsT0FBT3FDLEVBQUsxRCxVQUczQ3VJLEdBbkhYMUosRUFBQXVELHVGQ0ZBLE1BQUFxRCxFQUFBOUcsRUFBQSxHQUNBZ0QsRUFBQWhELEVBQUEsR0FDQWlELEVBQUFqRCxFQUFBLFNBS2EySSxFQW9CWHRHLFlBQVlnSyxFQUF5QkMsR0FKN0I5SixLQUFBK0osU0FLTi9KLEtBQUtnSyxTQUFXSCxFQUFhQyxHQUd4QmpLLDRCQUE0QmlGLEVBQW9CbUYsR0FDckQsSUFBS25GLEVBQVNvRixNQUFNL0QsRUFBWWdFLG1CQUM5QixPQUFTQyxRQUFTLEtBQU1DLE9BQVEscUJBQXNCaEgsVUFHeEQsTUFBT2lILEtBQU1DLEdBQU96RixFQUFTZSxJQUFJQyxHQUFLQyxTQUFTRCxFQUFHLEtBRWxELEdBQVEsRUFBSndFLElBQVVDLEVBQUloSCxPQUNoQixPQUFTNkcsUUFBUyxLQUFNQyxPQUFRLHFCQUFzQmhILFVBR3hELE1BQU1BLEtBQ04sSUFBSyxJQUFJekYsRUFBSSxFQUFHQSxFQUFJME0sRUFBRzFNLElBQUssQ0FDMUIsTUFBT3FDLEVBQUtDLEVBQUtzSyxHQUFRRCxFQUFJRSxNQUFVLEVBQUo3TSxFQUFXLEVBQUpBLEVBQVEsR0FDNUNrQyxHQUFhRyxJQUFLQSxFQUFNLEVBQUdDLElBQUtBLEVBQU0sR0FDdENyQixFQUFRdUIsS0FBS21KLElBQUksRUFBR2lCLEdBQzFCLEdBQUlQLEVBQVdULGFBQWExSixHQUMxQixPQUFTc0ssUUFBUyxLQUFNQyxPQUFRLG1CQUFvQmhILFVBRXREQSxFQUFNTyxLQUFLLElBQUlwRCxFQUFBWixLQUFLRSxFQUFVakIsSUFHaEMsT0FBU3VMLFFBQVMsS0FBTS9HLFNBR2xCeEQseUJBQXlCc0osR0FDL0IsT0FBT2hELEVBQVl1RSxnQkFBZ0JDLEtBQUt4QixHQUluQ3RKLGlCQUVMLE1BQU0rSyxHQUFtQixFQUFHLEdBQzVCLElBQUl2RixFQUFPLEVBQ1gsTUFBTXdGLEdBQVUsRUFBRyxHQUNiQyxHQUNKLElBQUl4RyxFQUFBNUQsYUFBYXlGLEVBQVk0RSxlQUFnQjVFLEVBQVk2RSxnQkFDekQsSUFBSTFHLEVBQUE1RCxhQUFheUYsRUFBWTRFLGVBQWdCNUUsRUFBWTZFLGlCQUdyREMsRUFBYyxDQUFDQyxFQUFnQmIsTUFFakNhLE9BQW1CLElBQVhBLEVBQWUsUUFBVSxTQUNqQ2IsU0FDQWhGLE9BQ0E4RixPQUNFeEosT0FBU3lKLEtBQU1SLEVBQWdCLEdBQUl4SSxNQUFPeUksRUFBTyxJQUNqRGpKLFFBQVV3SixLQUFNUixFQUFnQixHQUFJeEksTUFBT3lJLEVBQU8sT0FNeEQsSUFBSyxJQUFJUSxFQUFTLEVBQUdBLEVBQVMsRUFBR0EsSUFBVSxDQUN6QyxNQUFNQyxFQUFTdEwsS0FBS2dLLFFBQVFxQixHQUN0QnpDLEdBQVU5RCxVQUFXdUcsRUFBTy9LLFNBQVMsTUFDckNpTCxRQUFZRCxFQUFPRSxtQkFBbUI1QyxFQUFPekMsRUFBWXNGLG1CQU8vRCxHQUxBbEUsUUFBUUMsSUFBSStELEdBQ1p2TCxLQUFLK0osTUFBTW5HLE1BQU1nRixFQUFPMkMsSUFFeEJYLEVBQWdCUyxJQUFXRSxFQUFJRyxVQUVYLE9BQWhCSCxFQUFJbkIsUUFDTixNQUFvQixRQUFoQm1CLEVBQUluQixRQUNDYSxHQUFhSSxFQUFTLEdBQUssRUFBRyx1QkFHaENKLEdBQWFJLEVBQVMsR0FBSyxFQUFHLGlCQUd2QyxNQUFNaEIsRUFBUyxNQUNiLElBQUtrQixFQUFJSSxPQUNQLE1BQU8scUJBRVQsTUFBTUMsRUFBY0wsRUFBSUksT0FBTy9GLE1BQU0sS0FDckMsSUFBS2dHLEVBQVkxQixNQUFNL0QsRUFBWWdFLG1CQUNqQyxNQUFPLHFCQUdULE1BQU9sSyxFQUFLQyxHQUFPMEwsRUFBWS9GLElBQUlDLEdBQzFCQyxTQUFTRCxFQUFHLElBQU0sR0FFM0IsT0FBS2dGLEVBQU9PLEdBQVF4SyxNQUFNdUQsY0FBZW5FLE1BQUtDLFNBRzlDNEssR0FBUU8sRUFBUyxHQUFLLEdBQUd4SyxNQUFNaUMsV0FBVyxJQUFJdEMsRUFBQVosTUFBT0ssTUFBS0MsT0FBTyxJQUUxRCxNQUpFLG9CQWJJLEdBb0JmLEdBQUltSyxFQUNGLE9BQU9ZLEdBQWFJLEVBQVMsR0FBSyxFQUFHaEIsR0FLekMsSUFBS2hGLEVBQU8sRUFBR0EsR0FBUWMsRUFBWTBGLFNBQVV4RyxJQUMzQyxJQUFLLElBQUlnRyxFQUFTLEVBQUdBLEVBQVMsRUFBR0EsSUFBVSxDQUN6QyxNQUFNQyxFQUFTdEwsS0FBS2dLLFFBQVFxQixHQUN0QlMsRUFBVWhCLEVBQU9PLEdBQ2pCcEIsRUFBYWEsR0FBUU8sRUFBUyxHQUFLLEdBR3pDLElBQUtTLEVBQVFDLGlCQUNYLE9BQU9kLEdBQWFJLEVBQVMsR0FBSyxFQUFHLGdCQUd2QyxNQUFNekMsR0FBVTlELFVBQVdnSCxFQUFReEwsV0FBWTJKLEVBQVczSixhQUNwRGlMLFFBQVlELEVBQU9FLG1CQUFtQjVDLEVBQU96QyxFQUFZNkYsbUJBTy9ELEdBTEF6RSxRQUFRQyxJQUFJK0QsR0FDWnZMLEtBQUsrSixNQUFNbkcsTUFBTWdGLEVBQU8yQyxJQUV4QlgsRUFBZ0JTLElBQVdFLEVBQUlHLFVBRVgsT0FBaEJILEVBQUluQixRQUNOLE1BQW9CLFFBQWhCbUIsRUFBSW5CLFFBQ0NhLEdBQWFJLEVBQVMsR0FBSyxFQUFHLHVCQUVoQ0osR0FBYUksRUFBUyxHQUFLLEVBQUcsaUJBSXZDLE1BQU1oQixFQUFTLE1BQ2IsSUFBS2tCLEVBQUlJLE9BQ1AsTUFBTyxxQkFFVCxNQUFPaEcsS0FBWU0sR0FBVXNGLEVBQUlJLE9BQU8vRixNQUFNLEtBQzlDLElBQUtELEVBQ0gsTUFBTyxxQkFJVCxNQUFNSyxFQUFhRyxFQUFZQyxlQUFlM0gsSUFBSWtILEdBQ2xELElBQUtLLEVBQ0gsTUFBTyxvQkFFVCxNQUFNaUcsRUFBY0gsRUFBUXpGLEtBQUtMLEdBQ2pDLElBQUtpRyxFQUFZaEssTUFDZixNQUFPLG9CQUlULE1BQU1pSyxFQUFTL0YsRUFBWUcscUJBQXFCTCxFQUFRZ0UsRUFBV3BKLE9BQ25FLEdBQXVCLE9BQW5CcUwsRUFBTzlCLFFBQ1QsT0FBTyxFQUdULElBQUkrQixFQUFZLEVBTWhCLE9BTEFELEVBQU83SSxNQUFNaEIsUUFBUUUsSUFDbkIwSCxFQUFXcEosTUFBTWlDLFdBQVdQLEdBQzVCNEosR0FBYTVKLEVBQUsxRCxPQUFTLElBR3pCc04sSUFBYy9MLEtBQUttSixJQUFJLEVBQUcwQyxFQUFZOUosWUFBYyxHQUMvQyx3QkFHVDBJLEVBQU9RLElBQVdZLEVBQVk3SSxjQUV2QixPQXJDTSxHQXdDZixHQUFJaUgsRUFDRixPQUFPWSxHQUFhSSxFQUFTLEdBQUssRUFBR2hCLEdBTTNDLE9BQUlRLEVBQU8sR0FBS0EsRUFBTyxHQUNkSSxFQUFZLEVBQUcsU0FDYkosRUFBTyxHQUFLQSxFQUFPLEdBQ3JCSSxFQUFZLEVBQUcsU0FFZkEsRUFBWSxFQUFHLGNBSW5CcEwsZ0JBQWdCdU0sR0FDakIsR0E1TWlCakcsRUFBQUMsZUFBaUIsSUFBSWlHLE1BQ3pDLElBQUs1TCxFQUFBVyxVQUFVQyxLQUNmLElBQUtaLEVBQUFXLFVBQVVJLE9BQ2YsSUFBS2YsRUFBQVcsVUFBVU0sUUFDZixJQUFLakIsRUFBQVcsVUFBVUssUUFFSzBFLEVBQUE0RSxlQUFpQixFQUNqQjVFLEVBQUE2RSxlQUFpQixFQUVoQjdFLEVBQUFzRixrQkFBb0IsSUFDcEJ0RixFQUFBNkYsa0JBQW9CLElBQ3BCN0YsRUFBQTBGLFNBQVcsSUFFWDFGLEVBQUF1RSxnQkFBa0IsaUJBZDVDaE4sRUFBQXlJLDZGQ0xBekksRUFBQThLLG1CQUdFM0ksWUFBWTBJLEdBQ1Z2SSxLQUFLdUksY0FBZ0JBLEVBR2hCMUksUUFBUXlNLEdBQ2IvRixPQUFPZ0csc0JBQXNCLEtBQzNCdk0sS0FBS3dNLGVBQWV4TSxLQUFLdUksZUFFekIrRCxFQUFLakssUUFBUW9LLElBQ1hBLEVBQU9wSyxRQUFRcUssSUFDVEEsR0FDRjFNLEtBQUsyTSxRQUFRRCxTQU9oQjdNLGVBQWUrTSxHQUNwQixLQUFPQSxFQUFVQyxZQUNmRCxFQUFVRSxZQUFZRixFQUFVQyxZQUk3QmhOLFFBQVEwQyxHQUNiLElBQUtBLEVBQUsxRCxNQUNSLE9BR0YsTUFBTWtPLEVBQVVwRyxTQUFTbUIsY0FBYyxPQUNqQ2tGLEVBQVFyRyxTQUFTbUIsY0FBYyxPQUMvQmhJLEVBQVd5QyxFQUFLcEMsbUJBQXNCRixJQUFLc0MsRUFBS3RDLElBQUtDLElBQUtxQyxFQUFLckMsS0FDL0QrTSxFQUFnQmpOLEtBQUtpTixjQUFjbk4sR0FHbkNvTixHQUFXLGVBQWdCM0ssRUFBSzFELFFBQVNvTyxHQUUzQzFLLEVBQUsxRCxNQUFRLE1BQ2ZxTyxFQUFRdEosS0FBSyxjQUdmNUQsS0FBS21OLGFBQWFKLEVBQVNHLEdBRTNCRixFQUFNSSxVQUFVQyxJQUFJLGNBQ3BCTCxFQUFNTSxZQUFjL0ssRUFBSzFELE1BQU15QixTQUFTLElBRXBDaUMsRUFBS3BDLGlCQUVQb0csT0FBT2dHLHNCQUFzQixLQUMzQlcsRUFBUSxHQUFLbE4sS0FBS2lOLGVBQWdCaE4sSUFBS3NDLEVBQUt0QyxJQUFLQyxJQUFLcUMsRUFBS3JDLE1BQzNERixLQUFLbU4sYUFBYUosRUFBU0csS0FFcEIzSyxFQUFLSyxZQUNkc0ssRUFBUXRKLEtBQUssZUFDYjVELEtBQUttTixhQUFhSixFQUFTRyxHQUczQjNLLEVBQUtLLFdBQVdQLFFBQVFRLElBQ3RCN0MsS0FBSzJNLFFBQVE5SixPQUdmcUssRUFBUXRKLEtBQUssWUFDYjVELEtBQUttTixhQUFhSixFQUFTRyxJQUk3QkgsRUFBUXpFLFlBQVkwRSxHQUdwQmhOLEtBQUt1SSxjQUFjRCxZQUFZeUUsR0FHekJsTixjQUFjQyxHQUNwQix1QkFBd0JBLEVBQVNJLElBQU0sS0FBS0osRUFBU0csSUFBTSxJQUdyREosYUFBYTBOLEVBQXNCTCxHQUN6Q0ssRUFBUXhGLGFBQWEsUUFBU21GLEVBQVF0RCxLQUFLIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMyk7XG4iLCJpbXBvcnQgeyBQb3NpdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgVGlsZSB7XG4gIHB1YmxpYyByb3c6IG51bWJlcjtcbiAgcHVibGljIGNvbDogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgdmFsdWU/OiBudW1iZXI7XG4gIHB1YmxpYyBtZXJnZWRGcm9tPzogVGlsZVtdO1xuICBwdWJsaWMgcHJldmlvdXNQb3NpdGlvbj86IFBvc2l0aW9uO1xuXG4gIGNvbnN0cnVjdG9yKHBvc2l0aW9uOiBQb3NpdGlvbiwgaW5pdGlhbFZhbHVlPzogbnVtYmVyKSB7XG4gICAgdGhpcy5yb3cgPSBwb3NpdGlvbi5yb3c7XG4gICAgdGhpcy5jb2wgPSBwb3NpdGlvbi5jb2w7XG4gICAgdGhpcy52YWx1ZSA9IGluaXRpYWxWYWx1ZTtcbiAgfVxuXG4gIHB1YmxpYyBzYXZlUG9zaXRpb24oKSB7XG4gICAgdGhpcy5wcmV2aW91c1Bvc2l0aW9uID0geyByb3c6IHRoaXMucm93LCBjb2w6IHRoaXMuY29sIH07XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlUG9zaXRpb24ocG9zaXRpb246IFBvc2l0aW9uKSB7XG4gICAgdGhpcy5yb3cgPSBwb3NpdGlvbi5yb3c7XG4gICAgdGhpcy5jb2wgPSBwb3NpdGlvbi5jb2w7XG4gIH1cblxuICBwdWJsaWMgdG9TdHJpbmcoKSB7XG4gICAgaWYgKHRoaXMudmFsdWUpIHtcbiAgICAgIHJldHVybiBNYXRoLmxvZzIodGhpcy52YWx1ZSkudG9TdHJpbmcoMTApO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJzAnO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgSFRNTEFjdHVhdG9yIH0gZnJvbSAnLi4vLi4vLi4vdmlld2VyL3NyYy9IVE1MQWN0dWF0b3InO1xuaW1wb3J0IHsgQm9hcmQgfSBmcm9tICcuL0JvYXJkJztcbmltcG9ydCB7IFRpbGUgfSBmcm9tICcuL1RpbGUnO1xuaW1wb3J0IHsgRGlyZWN0aW9uLCBNb3ZlZFJlc3VsdCwgUG9zaXRpb24sIFZlY3RvcjIgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEJvYXJkTWFuYWdlciB7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IGRpcmVjdGlvbnMgPSBbRGlyZWN0aW9uLlVwLCBEaXJlY3Rpb24uRG93biwgRGlyZWN0aW9uLkxlZnQsIERpcmVjdGlvbi5SaWdodF07XG4gIHB1YmxpYyBib2FyZDogQm9hcmQ7XG4gIHByaXZhdGUgcmVhZG9ubHkgbmJSb3dzOiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgbmJDb2xzOiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgYWN0dWF0b3I/OiBIVE1MQWN0dWF0b3I7XG5cbiAgY29uc3RydWN0b3Iocm93czogbnVtYmVyLCBjb2xzOiBudW1iZXIsIGJvYXJkPzogQm9hcmQsIGFjdHVhdG9yPzogSFRNTEFjdHVhdG9yKSB7XG4gICAgdGhpcy5uYlJvd3MgPSByb3dzO1xuICAgIHRoaXMubmJDb2xzID0gY29scztcblxuICAgIGlmICghYm9hcmQpIHtcbiAgICAgIHRoaXMuYm9hcmQgPSBuZXcgQm9hcmQodGhpcy5uYlJvd3MsIHRoaXMubmJDb2xzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5ib2FyZCA9IGJvYXJkO1xuICAgIH1cblxuICAgIHRoaXMuYWN0dWF0b3IgPSBhY3R1YXRvcjtcbiAgICB0aGlzLmFjdHVhdGUoKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgR0VUX1ZFQ1RPUihkaXJlY3Rpb246IERpcmVjdGlvbik6IFZlY3RvcjIge1xuICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICBjYXNlIERpcmVjdGlvbi5VcDoge1xuICAgICAgICByZXR1cm4geyB4OiAwLCB5OiAtMSB9O1xuICAgICAgfVxuICAgICAgY2FzZSBEaXJlY3Rpb24uRG93bjoge1xuICAgICAgICByZXR1cm4geyB4OiAwLCB5OiAxIH07XG4gICAgICB9XG4gICAgICBjYXNlIERpcmVjdGlvbi5MZWZ0OiB7XG4gICAgICAgIHJldHVybiB7IHg6IC0xLCB5OiAwIH07XG4gICAgICB9XG4gICAgICBjYXNlIERpcmVjdGlvbi5SaWdodDoge1xuICAgICAgICByZXR1cm4geyB4OiAxLCB5OiAwIH07XG4gICAgICB9XG4gICAgICBkZWZhdWx0OiB7XG4gICAgICAgIHJldHVybiB7IHg6IDAsIHk6IDAgfTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBwb3NpdGlvbnNFcXVhbChmaXJzdDogUG9zaXRpb24sIHNlY29uZDogUG9zaXRpb24pIHtcbiAgICByZXR1cm4gZmlyc3Qucm93ID09PSBzZWNvbmQucm93ICYmIGZpcnN0LmNvbCA9PT0gc2Vjb25kLmNvbDtcbiAgfVxuXG4gIHB1YmxpYyBtb3ZlKGRpcmVjdGlvbjogRGlyZWN0aW9uKTogTW92ZWRSZXN1bHQge1xuICAgIGNvbnN0IHZlY3RvciA9IEJvYXJkTWFuYWdlci5HRVRfVkVDVE9SKGRpcmVjdGlvbik7XG4gICAgY29uc3QgdHJhdmVyc2FscyA9IHRoaXMuYnVpbGRUcmF2ZXJzYWxzKHZlY3Rvcik7XG4gICAgbGV0IG1vdmVkID0gZmFsc2U7XG5cbiAgICB0aGlzLnByZXBhcmVUaWxlcygpO1xuXG4gICAgbGV0IGNvdW50TWVyZ2VkID0gMDtcbiAgICBsZXQgc2NvcmUgPSAwO1xuICAgIHRyYXZlcnNhbHMucm93LmZvckVhY2gocm93ID0+IHtcbiAgICAgIHRyYXZlcnNhbHMuY29sLmZvckVhY2goY29sID0+IHtcbiAgICAgICAgY29uc3QgdGlsZVBvc2l0aW9uID0geyByb3c6IHJvdywgY29sOiBjb2wgfTtcbiAgICAgICAgY29uc3QgdGlsZSA9IHRoaXMuYm9hcmQudGlsZUF0KHRpbGVQb3NpdGlvbik7XG5cbiAgICAgICAgaWYgKHRpbGUgJiYgdGlsZS52YWx1ZSkge1xuICAgICAgICAgIGNvbnN0IHBvc2l0aW9ucyA9IHRoaXMuZmluZEZhcnRoZXN0UG9zaXRpb24odGlsZVBvc2l0aW9uLCB2ZWN0b3IpO1xuICAgICAgICAgIGNvbnN0IG5leHQgPSB0aGlzLmJvYXJkLnRpbGVBdChwb3NpdGlvbnMubmV4dCk7XG5cbiAgICAgICAgICBpZiAobmV4dCAmJiBuZXh0LnZhbHVlID09PSB0aWxlLnZhbHVlICYmICFuZXh0Lm1lcmdlZEZyb20pIHtcbiAgICAgICAgICAgIGNvbnN0IG1lcmdlZCA9IG5ldyBUaWxlKHBvc2l0aW9ucy5uZXh0LCB0aWxlLnZhbHVlICogMik7XG4gICAgICAgICAgICBtZXJnZWQubWVyZ2VkRnJvbSA9IFt0aWxlLCBuZXh0XTtcblxuICAgICAgICAgICAgdGhpcy5ib2FyZC5pbnNlcnRUaWxlKG1lcmdlZCk7XG4gICAgICAgICAgICB0aGlzLmJvYXJkLnJlbW92ZVRpbGUodGlsZSk7XG5cbiAgICAgICAgICAgIHRpbGUudXBkYXRlUG9zaXRpb24ocG9zaXRpb25zLm5leHQpO1xuXG4gICAgICAgICAgICBjb3VudE1lcmdlZCsrO1xuICAgICAgICAgICAgc2NvcmUgKz0gdGlsZS52YWx1ZSAqIDI7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubW92ZVRpbGUodGlsZSwgcG9zaXRpb25zLmZhcnRoZXN0KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIUJvYXJkTWFuYWdlci5wb3NpdGlvbnNFcXVhbCh0aWxlUG9zaXRpb24sIHRpbGUpKSB7XG4gICAgICAgICAgICBtb3ZlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGlmIChtb3ZlZCkge1xuICAgICAgdGhpcy5hY3R1YXRlKCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtb3ZlZDogdHJ1ZSxcbiAgICAgICAgY291bnRNZXJnZWQsXG4gICAgICAgIHNjb3JlT2J0YWluZWQ6IHNjb3JlLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgbW92ZWQ6IGZhbHNlLFxuICAgICAgY291bnRNZXJnZWQ6IDAsXG4gICAgICBzY29yZU9idGFpbmVkOiAwLFxuICAgIH07XG4gIH1cblxuICBwdWJsaWMgYWN0dWF0ZSgpIHtcbiAgICBpZiAodGhpcy5hY3R1YXRvcikge1xuICAgICAgdGhpcy5hY3R1YXRvci5hY3R1YXRlKHRoaXMuYm9hcmQudGlsZXMpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBtb3Zlc0F2YWlsYWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5ib2FyZC5nZXRBdmFpbGFibGVUaWxlcygpLmxlbmd0aCA+IDAgfHwgdGhpcy50aWxlTWF0Y2hlc0F2YWlsYWJsZSgpO1xuICB9XG5cbiAgcHVibGljIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiB0aGlzLmJvYXJkLnRvU3RyaW5nKCk7XG4gIH1cblxuICBwdWJsaWMgcHJlcGFyZVRpbGVzKCkge1xuICAgIHRoaXMuYm9hcmQuZWFjaFRpbGUoKHg6IG51bWJlciwgeTogbnVtYmVyLCB0aWxlOiBUaWxlKSA9PiB7XG4gICAgICBpZiAodGlsZS52YWx1ZSkge1xuICAgICAgICB0aWxlLm1lcmdlZEZyb20gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRpbGUuc2F2ZVBvc2l0aW9uKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgc2V0dXAoKSB7XG4gICAgdGhpcy5ib2FyZCA9IG5ldyBCb2FyZCh0aGlzLm5iUm93cywgdGhpcy5uYkNvbHMpO1xuICAgIHRoaXMuYWN0dWF0ZSgpO1xuICB9XG5cbiAgcHVibGljIGJ1aWxkVHJhdmVyc2Fscyh2ZWN0b3I6IFZlY3RvcjIpIHtcbiAgICBjb25zdCB0cmF2ZXJzYWxzOiB7IHJvdzogbnVtYmVyW107IGNvbDogbnVtYmVyW10gfSA9IHsgcm93OiBbXSwgY29sOiBbXSB9O1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUm93czsgaSsrKSB7XG4gICAgICB0cmF2ZXJzYWxzLnJvdy5wdXNoKGkpO1xuICAgIH1cbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMubmJDb2xzOyBqKyspIHtcbiAgICAgIHRyYXZlcnNhbHMuY29sLnB1c2goaik7XG4gICAgfVxuICAgIGlmICh2ZWN0b3IueCA9PT0gMSkge1xuICAgICAgdHJhdmVyc2Fscy5jb2wgPSB0cmF2ZXJzYWxzLmNvbC5yZXZlcnNlKCk7XG4gICAgfVxuICAgIGlmICh2ZWN0b3IueSA9PT0gMSkge1xuICAgICAgdHJhdmVyc2Fscy5yb3cgPSB0cmF2ZXJzYWxzLnJvdy5yZXZlcnNlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRyYXZlcnNhbHM7XG4gIH1cblxuICBwcml2YXRlIHRpbGVNYXRjaGVzQXZhaWxhYmxlKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYlJvd3M7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLm5iQ29sczsgaisrKSB7XG4gICAgICAgIGNvbnN0IHRpbGUgPSB0aGlzLmJvYXJkLnRpbGVBdCh7IHJvdzogaSwgY29sOiBqIH0pO1xuXG4gICAgICAgIGlmICh0aWxlICYmIHRpbGUudmFsdWUpIHtcbiAgICAgICAgICBjb25zdCBtb3ZhYmxlID0gQm9hcmRNYW5hZ2VyLmRpcmVjdGlvbnMuc29tZShcbiAgICAgICAgICAgIChkaXJlY3Rpb24pOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgdmVjdG9yID0gQm9hcmRNYW5hZ2VyLkdFVF9WRUNUT1IoZGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgY29uc3QgdGlsZVBvc2l0aW9uID0geyByb3c6IGkgKyB2ZWN0b3IueSwgY29sOiBqICsgdmVjdG9yLnggfTtcbiAgICAgICAgICAgICAgY29uc3Qgb3RoZXJUaWxlID0gdGhpcy5ib2FyZC50aWxlQXQodGlsZVBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgcmV0dXJuICEhb3RoZXJUaWxlICYmIG90aGVyVGlsZS52YWx1ZSA9PT0gdGlsZS52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChtb3ZhYmxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcHJpdmF0ZSBmaW5kRmFydGhlc3RQb3NpdGlvbih0aWxlUG9zaXRpb246IFBvc2l0aW9uLCB2ZWN0b3I6IFZlY3RvcjIpIHtcbiAgICBsZXQgcHJldmlvdXM7XG4gICAgbGV0IGN1cnJlbnQgPSB0aWxlUG9zaXRpb247XG4gICAgZG8ge1xuICAgICAgcHJldmlvdXMgPSBjdXJyZW50O1xuICAgICAgY3VycmVudCA9IHsgcm93OiBwcmV2aW91cy5yb3cgKyB2ZWN0b3IueSwgY29sOiBwcmV2aW91cy5jb2wgKyB2ZWN0b3IueCB9O1xuICAgIH0gd2hpbGUgKHRoaXMuYm9hcmQud2l0aGluQm91bmRzKGN1cnJlbnQpICYmIHRoaXMuYm9hcmQudGlsZUF2YWlsYWJsZShjdXJyZW50KSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZmFydGhlc3Q6IHByZXZpb3VzLFxuICAgICAgbmV4dDogY3VycmVudCxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBtb3ZlVGlsZSh0aWxlOiBUaWxlLCBwb3NpdGlvbjogUG9zaXRpb24pIHtcbiAgICB0aGlzLmJvYXJkLnJlbW92ZVRpbGUodGlsZSk7XG4gICAgdGlsZS51cGRhdGVQb3NpdGlvbihwb3NpdGlvbik7XG4gICAgdGhpcy5ib2FyZC5pbnNlcnRUaWxlKHRpbGUpO1xuICB9XG59XG4iLCIvKipcbiAqIFRoZSBkaXJlY3Rpb24gaW4gd2hpY2ggdG8gbW92ZSB0aGUgYm9hcmRcbiAqL1xuZXhwb3J0IGVudW0gRGlyZWN0aW9uIHtcbiAgVXAgPSAnVVAnLFxuICBEb3duID0gJ0RPV04nLFxuICBMZWZ0ID0gJ0xFRlQnLFxuICBSaWdodCA9ICdSSUdIVCcsXG59XG5cbi8qKlxuICogVGhlIHBvc2l0aW9uIG9mIGEgdGlsZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFBvc2l0aW9uIHtcbiAgcm93OiBudW1iZXI7XG4gIGNvbDogbnVtYmVyO1xufVxuXG4vKipcbiAqIEEgcmVwcmVzZW50YXRpb24gb2YgYSAyRCB2ZWN0b3JcbiAqIHggaXMgdGhlIGhvcml6b250YWwgYXhpcyBmcm9tIGxlZnQgdG8gcmlnaHRcbiAqIHkgaXMgdGhlIHZlcnRpY2FsIGF4aXMgZnJvbSB0b3AgdG8gYm90dG9tXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVmVjdG9yMiB7XG4gIHg6IG51bWJlcjtcbiAgeTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1vdmVkUmVzdWx0IHtcbiAgbW92ZWQ6IGJvb2xlYW47XG4gIGNvdW50TWVyZ2VkOiBudW1iZXI7XG4gIHNjb3JlT2J0YWluZWQ6IG51bWJlcjtcbn1cbiIsImltcG9ydCB7IEJvYXJkTWFuYWdlciB9IGZyb20gJy4uLy4uL2dhbWUvc3JjL0NvcmUvQm9hcmRNYW5hZ2VyJztcbmltcG9ydCB7IFRpbGUgfSBmcm9tICcuLi8uLi9nYW1lL3NyYy9Db3JlL1RpbGUnO1xuaW1wb3J0IHsgR2FtZU1hbmFnZXIgfSBmcm9tICcuLi8uLi9nYW1lL3NyYy9HYW1lTWFuYWdlcic7XG5pbXBvcnQgeyBUdXJuUmVjb3JkIH0gZnJvbSAnLi4vLi4vZ2FtZS9zcmMvdHlwZXMnO1xuaW1wb3J0IHsgSFRNTEFjdHVhdG9yIH0gZnJvbSAnLi9IVE1MQWN0dWF0b3InO1xuXG5jb25zdCBuUm93ID0gNTtcbmNvbnN0IG5Db2wgPSA1O1xuXG5jb25zdCBibXM6IEJvYXJkTWFuYWdlcltdID0gW107XG5sZXQgY29tbWFuZHM6IFR1cm5SZWNvcmRbXSA9IFtdO1xuXG5sZXQgZ2FtZUludGVydmFsID0gODAwO1xubGV0IHRpbWVySWQ6IG51bWJlciB8IHVuZGVmaW5lZDtcblxubGV0IHR1cm5UZXh0OiBIVE1MRWxlbWVudCB8IG51bGw7XG5cbmZ1bmN0aW9uIHRpbWVyVGFzayh0dXJuOiBudW1iZXIpIHtcbiAgaWYgKGNvbW1hbmRzLmxlbmd0aCA8PSB0dXJuKSB7XG4gICAgdGltZXJJZCA9IHVuZGVmaW5lZDtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodHVyblRleHQpIHtcbiAgICB0dXJuVGV4dC5pbm5lclRleHQgPSBTdHJpbmcoTWF0aC5mbG9vcih0dXJuIC8gMiArIDEpKTtcbiAgfVxuXG4gIGNvbnN0IG9iaiA9IGNvbW1hbmRzW3R1cm5dO1xuICBpZiAob2JqLmFpb3V0cHV0KSB7XG4gICAgY29uc3QgY29tbWFuZCA9IG9iai5haW91dHB1dC5zcGxpdCgnICcpO1xuICAgIGlmICh0dXJuIDwgMikge1xuICAgICAgLy8gcHV0IGluaXRpYWwgdGlsZXNcbiAgICAgIGNvbnN0IFtyb3csIGNvbF0gPSBjb21tYW5kLm1hcCh2ID0+IHtcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHYsIDEwKSAtIDE7XG4gICAgICB9KTtcbiAgICAgIGJtc1sodHVybiArIDEpICUgMl0uYm9hcmQuaW5zZXJ0VGlsZShuZXcgVGlsZSh7IHJvdywgY29sIH0sIDIpKTtcbiAgICAgIGJtc1sodHVybiArIDEpICUgMl0uYWN0dWF0ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBbZGlyQ29tbWFuZCwgLi4uYXR0YWNrXSA9IGNvbW1hbmQ7XG5cbiAgICAgIC8vIE1vdmVcbiAgICAgIGNvbnN0IGRpciA9IEdhbWVNYW5hZ2VyLkRJUkVDVElPTlNfTUFQLmdldChkaXJDb21tYW5kKTtcbiAgICAgIGlmIChkaXIpIHtcbiAgICAgICAgYm1zW3R1cm4gJSAyXS5tb3ZlKGRpcik7XG4gICAgICB9XG5cbiAgICAgIC8vIEF0dGFja1xuICAgICAgYm1zWyh0dXJuICsgMSkgJSAyXS5wcmVwYXJlVGlsZXMoKTtcbiAgICAgIGNvbnN0IHBhcnNlZCA9IEdhbWVNYW5hZ2VyLlBBUlNFX0FUVEFDS19DT01NQU5EKGF0dGFjaywgYm1zWyh0dXJuICsgMSkgJSAyXS5ib2FyZCk7XG4gICAgICBwYXJzZWQudGlsZXMuZm9yRWFjaCh0aWxlID0+IHtcbiAgICAgICAgYm1zWyh0dXJuICsgMSkgJSAyXS5ib2FyZC5pbnNlcnRUaWxlKHRpbGUpO1xuICAgICAgfSk7XG4gICAgICBibXNbKHR1cm4gKyAxKSAlIDJdLmFjdHVhdGUoKTtcbiAgICB9XG4gIH1cblxuICB0aW1lcklkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHRpbWVyVGFzayh0dXJuICsgMSk7XG4gIH0sIGdhbWVJbnRlcnZhbCk7XG59XG5cbmZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW9uKCkge1xuICBpZiAodGltZXJJZCkge1xuICAgIGNsZWFyVGltZW91dCh0aW1lcklkKTtcbiAgfVxuXG4gIC8vIENsZWFyIGJvYXJkXG4gIGJtcy5mb3JFYWNoKGJtID0+IHtcbiAgICBibS5zZXR1cCgpO1xuICB9KTtcblxuICB0aW1lclRhc2soMCk7XG59XG5cbmZ1bmN0aW9uIGxvYWRGaWxlKCkge1xuICBjb25zdCBpbnB1dEVsZW1lbnQgPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZScpO1xuICBpZiAoIWlucHV0RWxlbWVudCB8fCAhaW5wdXRFbGVtZW50LmZpbGVzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgZmlsZSA9IGlucHV0RWxlbWVudC5maWxlc1swXTtcbiAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICByZWFkZXIub25sb2FkID0gKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb21tYW5kcyA9IEpTT04ucGFyc2UoPHN0cmluZz5yZWFkZXIucmVzdWx0KTtcbiAgICAgIHN0YXJ0QW5pbWF0aW9uKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgYWxlcnQoJ+ODh+ODvOOCv+OBrua6luWCmeOBq+WkseaVl+OBl+OBvuOBl+OBn+OAgicpO1xuICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgfVxuICB9O1xuICByZWFkZXIucmVhZEFzVGV4dChmaWxlLCAndXRmLTgnKTtcbn1cblxuZnVuY3Rpb24gcHJlcGFyZUZpZWxkKCkge1xuICBbJyNmcmFtZTEgLmdhbWUtY29udGFpbmVyJywgJyNmcmFtZTIgLmdhbWUtY29udGFpbmVyJ10uZm9yRWFjaChmcmFtZVF1ZXJ5ID0+IHtcbiAgICBjb25zdCBnYW1lQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihmcmFtZVF1ZXJ5KTtcbiAgICBpZiAoZ2FtZUNvbnRhaW5lcikge1xuICAgICAgY29uc3QgZ3JpZENvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnRXaXRoQ2xhc3MoJ2RpdicsICdncmlkLWNvbnRhaW5lcicpO1xuXG4gICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCBuUm93OyByb3crKykge1xuICAgICAgICBjb25zdCBncmlkUm93ID0gY3JlYXRlRWxlbWVudFdpdGhDbGFzcygnZGl2JywgJ2dyaWQtcm93Jyk7XG4gICAgICAgIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IG5Db2w7IGNvbCsrKSB7XG4gICAgICAgICAgZ3JpZFJvdy5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50V2l0aENsYXNzKCdkaXYnLCAnZ3JpZC1jZWxsJykpO1xuICAgICAgICB9XG4gICAgICAgIGdyaWRDb250YWluZXIuYXBwZW5kQ2hpbGQoZ3JpZFJvdyk7XG4gICAgICB9XG4gICAgICBnYW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKGdyaWRDb250YWluZXIpO1xuXG4gICAgICBjb25zdCB0aWxlQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudFdpdGhDbGFzcygnZGl2JywgJ3RpbGUtY29udGFpbmVyJyk7XG4gICAgICBnYW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKHRpbGVDb250YWluZXIpO1xuXG4gICAgICBibXMucHVzaChuZXcgQm9hcmRNYW5hZ2VyKG5Sb3csIG5Db2wsIHVuZGVmaW5lZCwgbmV3IEhUTUxBY3R1YXRvcih0aWxlQ29udGFpbmVyKSkpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnRXaXRoQ2xhc3ModGFnTmFtZTogc3RyaW5nLCBjbGFzc05hbWU6IHN0cmluZykge1xuICBjb25zdCBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcbiAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgY2xhc3NOYW1lKTtcbiAgcmV0dXJuIGVsZW07XG59XG5cbmZ1bmN0aW9uIHByZXBhcmVCdXR0b25zKCkge1xuICBjb25zdCBzbGlkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2FtZS1pbnRlcnZhbC1zbGlkZXInKTtcbiAgaWYgKHNsaWRlcikge1xuICAgIHNsaWRlci5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgZ2FtZUludGVydmFsLnRvU3RyaW5nKCkpO1xuICAgIHNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBldmVudCA9PiB7XG4gICAgICBnYW1lSW50ZXJ2YWwgPSBwYXJzZUludCgoPEhUTUxJbnB1dEVsZW1lbnQ+ZXZlbnQudGFyZ2V0KS52YWx1ZSwgMTApO1xuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZScpO1xuICBjb25zb2xlLmxvZyhpbnB1dCk7XG4gIGlmIChpbnB1dCkge1xuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGxvYWRGaWxlKTtcbiAgfVxuXG4gIGNvbnN0IHJlc3RhcnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGFydC1idXR0b24nKTtcbiAgaWYgKHJlc3RhcnQpIHtcbiAgICByZXN0YXJ0Lm9uY2xpY2sgPSBsb2FkRmlsZTtcbiAgfVxuXG4gIHR1cm5UZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1cm4nKTtcbiAgaWYgKHR1cm5UZXh0KSB7XG4gICAgdHVyblRleHQuaW5uZXJUZXh0ID0gJzAnO1xuICB9XG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuICBwcmVwYXJlRmllbGQoKTtcbiAgcHJlcGFyZUJ1dHRvbnMoKTtcbn0pO1xuIiwiaW1wb3J0IHsgVGlsZSB9IGZyb20gJy4vVGlsZSc7XG5pbXBvcnQgeyBQb3NpdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQm9hcmQge1xuICBwdWJsaWMgcmVhZG9ubHkgdGlsZXM6IFRpbGVbXVtdO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgbmJSb3dzOiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgbmJDb2xzOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3Iocm93czogbnVtYmVyLCBjb2xzOiBudW1iZXIpIHtcbiAgICB0aGlzLm5iUm93cyA9IHJvd3M7XG4gICAgdGhpcy5uYkNvbHMgPSBjb2xzO1xuICAgIHRoaXMudGlsZXMgPSBCb2FyZC5jcmVhdGVFbXB0eVRpbGVCb2FyZCh0aGlzLm5iUm93cywgdGhpcy5uYkNvbHMpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBGUk9NX1NUUklOR1Moc3RyaW5nczogc3RyaW5nW10pOiBCb2FyZCB7XG4gICAgLy8gVE9ETyBhc3NlcnQgaW52YWxpZCBpbnB1dFxuICAgIGNvbnN0IG51bWJlcnMgPSBzdHJpbmdzLm1hcChzdHIgPT5cbiAgICAgIHN0clxuICAgICAgICAudHJpbSgpXG4gICAgICAgIC5zcGxpdCgnICcpXG4gICAgICAgIC5tYXAodiA9PiBwYXJzZUludCh2LCAxMCkpXG4gICAgKTtcbiAgICBjb25zdCBuUm93cyA9IG51bWJlcnMubGVuZ3RoO1xuICAgIGNvbnN0IG5Db2xzID0gbnVtYmVyc1swXS5sZW5ndGg7XG4gICAgY29uc3QgYm9hcmQgPSBuZXcgQm9hcmQoblJvd3MsIG5Db2xzKTtcblxuICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IG5Sb3dzOyByb3crKykge1xuICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgbkNvbHM7IGNvbCsrKSB7XG4gICAgICAgIGlmIChudW1iZXJzW3Jvd11bY29sXSA+IDApIHtcbiAgICAgICAgICBib2FyZC5pbnNlcnRUaWxlKG5ldyBUaWxlKHsgcm93LCBjb2wgfSwgTWF0aC5wb3coMiwgbnVtYmVyc1tyb3ddW2NvbF0pKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJvYXJkO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlRW1wdHlUaWxlQm9hcmQobmJSb3dzOiBudW1iZXIsIG5iQ29sczogbnVtYmVyKSB7XG4gICAgY29uc3QgdGlsZXM6IFRpbGVbXVtdID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5iUm93czsgaSsrKSB7XG4gICAgICB0aWxlc1tpXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBuYkNvbHM7IGorKykge1xuICAgICAgICB0aWxlc1tpXVtqXSA9IG5ldyBUaWxlKHsgcm93OiBpLCBjb2w6IGogfSwgdW5kZWZpbmVkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRpbGVzO1xuICB9XG5cbiAgcHVibGljIHdpdGhpbkJvdW5kcyhwb3NpdGlvbjogUG9zaXRpb24pIHtcbiAgICByZXR1cm4gcG9zaXRpb24ucm93ID49IDAgJiYgcG9zaXRpb24ucm93IDwgdGhpcy5uYlJvd3MgJiYgcG9zaXRpb24uY29sID49IDAgJiYgcG9zaXRpb24uY29sIDwgdGhpcy5uYkNvbHM7XG4gIH1cblxuICBwdWJsaWMgaW5zZXJ0VGlsZSh0aWxlOiBUaWxlKSB7XG4gICAgdGhpcy50aWxlc1t0aWxlLnJvd11bdGlsZS5jb2xdID0gdGlsZTtcbiAgfVxuXG4gIHB1YmxpYyByZW1vdmVUaWxlKHRpbGU6IFRpbGUpIHtcbiAgICB0aGlzLnRpbGVzW3RpbGUucm93XVt0aWxlLmNvbF0gPSBuZXcgVGlsZSh7IHJvdzogdGlsZS5yb3csIGNvbDogdGlsZS5jb2wgfSwgdW5kZWZpbmVkKTtcbiAgfVxuXG4gIHB1YmxpYyB0aWxlQXQocG9zaXRpb246IFBvc2l0aW9uKSB7XG4gICAgaWYgKHRoaXMud2l0aGluQm91bmRzKHBvc2l0aW9uKSAmJiB0aGlzLnRpbGVzW3Bvc2l0aW9uLnJvd11bcG9zaXRpb24uY29sXS52YWx1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMudGlsZXNbcG9zaXRpb24ucm93XVtwb3NpdGlvbi5jb2xdO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyB0aWxlQXZhaWxhYmxlKHBvc2l0aW9uOiBQb3NpdGlvbikge1xuICAgIHJldHVybiAhdGhpcy50aWxlT2NjdXBpZWQocG9zaXRpb24pO1xuICB9XG5cbiAgcHVibGljIGdldFJhbmRvbUF2YWlsYWJsZVRpbGUoKSB7XG4gICAgY29uc3QgYXZhaWxhYmxlVGlsZXMgPSB0aGlzLmdldEF2YWlsYWJsZVRpbGVzKCk7XG4gICAgaWYgKGF2YWlsYWJsZVRpbGVzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGF2YWlsYWJsZVRpbGVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGF2YWlsYWJsZVRpbGVzLmxlbmd0aCldO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBnZXRBdmFpbGFibGVUaWxlcygpIHtcbiAgICBjb25zdCBhdmFpbGFibGVUaWxlczogVGlsZVtdID0gW107XG4gICAgdGhpcy5lYWNoVGlsZSgocm93OiBudW1iZXIsIGNvbDogbnVtYmVyLCB0aWxlOiBUaWxlKSA9PiB7XG4gICAgICBpZiAoIXRpbGUudmFsdWUpIHtcbiAgICAgICAgYXZhaWxhYmxlVGlsZXMucHVzaChuZXcgVGlsZSh7IHJvdywgY29sIH0sIHVuZGVmaW5lZCkpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBhdmFpbGFibGVUaWxlcztcbiAgfVxuXG4gIHB1YmxpYyBlYWNoVGlsZShjYWxsYmFjazogKHJvdzogbnVtYmVyLCBjb2w6IG51bWJlciwgdGlsZTogVGlsZSkgPT4gYW55KSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5iUm93czsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMubmJDb2xzOyBqKyspIHtcbiAgICAgICAgY2FsbGJhY2soaSwgaiwgdGhpcy50aWxlc1tpXVtqXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHRpbGVPY2N1cGllZChwb3NpdGlvbjogUG9zaXRpb24pIHtcbiAgICBjb25zdCB0aWxlID0gdGhpcy50aWxlQXQocG9zaXRpb24pO1xuICAgIGlmICh0aWxlKSB7XG4gICAgICByZXR1cm4gISF0aWxlLnZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy50aWxlcy5tYXAocm93ID0+IHJvdy5tYXAodGlsZSA9PiB0aWxlLnRvU3RyaW5nKCkpLmpvaW4oJyAnKSkuam9pbignXFxuJyk7XG4gIH1cblxuICBwdWJsaWMgY2xvbmUoKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IEJvYXJkKHRoaXMubmJSb3dzLCB0aGlzLm5iQ29scyk7XG4gICAgdGhpcy5lYWNoVGlsZSgocm93LCBjb2wsIHRpbGUpID0+IHtcbiAgICAgIGlmICh0aWxlICYmIHRpbGUudmFsdWUgJiYgdGlsZS52YWx1ZSA+IDApIHtcbiAgICAgICAgcmVzdWx0Lmluc2VydFRpbGUobmV3IFRpbGUoeyByb3csIGNvbCB9LCB0aWxlLnZhbHVlKSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxufVxuIiwiaW1wb3J0IHsgQm9hcmQgfSBmcm9tICcuL0NvcmUvQm9hcmQnO1xuaW1wb3J0IHsgQm9hcmRNYW5hZ2VyIH0gZnJvbSAnLi9Db3JlL0JvYXJkTWFuYWdlcic7XG5pbXBvcnQgeyBUaWxlIH0gZnJvbSAnLi9Db3JlL1RpbGUnO1xuaW1wb3J0IHsgRGlyZWN0aW9uIH0gZnJvbSAnLi9Db3JlL3R5cGVzJztcbmltcG9ydCB7IFJ1bm5lckJhc2UgfSBmcm9tICcuL1J1bm5lci9SdW5uZXJCYXNlJztcbmltcG9ydCB7IElucHV0LCBPdXRwdXQgfSBmcm9tICcuL1J1bm5lci90eXBlcyc7XG5pbXBvcnQgeyBHYW1lUmVzdWx0LCBHYW1lUmVzdWx0UmVhc29uLCBUdXJuUmVjb3JkIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBHYW1lTWFuYWdlciB7XG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgRElSRUNUSU9OU19NQVAgPSBuZXcgTWFwKFtcbiAgICBbJ1UnLCBEaXJlY3Rpb24uVXBdLFxuICAgIFsnRCcsIERpcmVjdGlvbi5Eb3duXSxcbiAgICBbJ1InLCBEaXJlY3Rpb24uUmlnaHRdLFxuICAgIFsnTCcsIERpcmVjdGlvbi5MZWZ0XSxcbiAgXSk7XG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgQk9BUkRfTlVNX1JPV1MgPSA1O1xuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEJPQVJEX05VTV9DT0xTID0gNTtcblxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBJTlRJQUxJWkVfVElNRV9NUyA9IDUwMDtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTUFJTl9UVVJOX1RJTUVfTVMgPSAxMDA7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE1BWF9UVVJOID0gMTAwMDtcblxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBQT1NJVElWRV9SRUdFWFAgPSAvXlxcKzB8WzEtOV1cXGQqJC87XG5cbiAgcHJpdmF0ZSBpb0xvZzogW0lucHV0LCBPdXRwdXRdW10gPSBbXTtcblxuICBwcml2YXRlIHJlYWRvbmx5IHJ1bm5lcnM6IFJ1bm5lckJhc2VbXTtcblxuICBjb25zdHJ1Y3RvcihmaXJzdFBsYXllcjogUnVubmVyQmFzZSwgc2Vjb25kUGxheWVyOiBSdW5uZXJCYXNlKSB7XG4gICAgdGhpcy5ydW5uZXJzID0gW2ZpcnN0UGxheWVyLCBzZWNvbmRQbGF5ZXJdO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBQQVJTRV9BVFRBQ0tfQ09NTUFORChjb21tYW5kczogc3RyaW5nW10sIGVuZW15Qm9hcmQ6IEJvYXJkKSB7XG4gICAgaWYgKCFjb21tYW5kcy5ldmVyeShHYW1lTWFuYWdlci5pc1Bvc2l0aXZlSW50ZWdlcikpIHtcbiAgICAgIHJldHVybiB7IHZlcmRpY3Q6ICdORycsIHJlYXNvbjogJ1BSRVNFTlRBVElPTl9FUlJPUicsIHRpbGVzOiA8VGlsZVtdPltdIH07XG4gICAgfVxuXG4gICAgY29uc3QgW00sIC4uLnZlY10gPSBjb21tYW5kcy5tYXAodiA9PiBwYXJzZUludCh2LCAxMCkpO1xuXG4gICAgaWYgKE0gKiAzICE9PSB2ZWMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4geyB2ZXJkaWN0OiAnTkcnLCByZWFzb246ICdQUkVTRU5UQVRJT05fRVJST1InLCB0aWxlczogPFRpbGVbXT5bXSB9O1xuICAgIH1cblxuICAgIGNvbnN0IHRpbGVzOiBUaWxlW10gPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IE07IGkrKykge1xuICAgICAgY29uc3QgW3JvdywgY29sLCBwVmFsXSA9IHZlYy5zbGljZShpICogMywgaSAqIDMgKyAzKTtcbiAgICAgIGNvbnN0IHBvc2l0aW9uID0geyByb3c6IHJvdyAtIDEsIGNvbDogY29sIC0gMSB9O1xuICAgICAgY29uc3QgdmFsdWUgPSBNYXRoLnBvdygyLCBwVmFsKTtcbiAgICAgIGlmIChlbmVteUJvYXJkLnRpbGVPY2N1cGllZChwb3NpdGlvbikpIHtcbiAgICAgICAgcmV0dXJuIHsgdmVyZGljdDogJ05HJywgcmVhc29uOiAnSU5WQUxJRF9QT1NJVElPTicsIHRpbGVzOiA8VGlsZVtdPltdIH07XG4gICAgICB9XG4gICAgICB0aWxlcy5wdXNoKG5ldyBUaWxlKHBvc2l0aW9uLCB2YWx1ZSkpO1xuICAgIH1cblxuICAgIHJldHVybiB7IHZlcmRpY3Q6ICdPSycsIHRpbGVzIH07XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBpc1Bvc2l0aXZlSW50ZWdlcihzdHI6IHN0cmluZykge1xuICAgIHJldHVybiBHYW1lTWFuYWdlci5QT1NJVElWRV9SRUdFWFAudGVzdChzdHIpO1xuICB9XG5cbiAgLy8gdHNsaW50OmRpc2FibGUgbWF4LWZ1bmMtYm9keS1sZW5ndGggVE9ETyBmaXhtZVxuICBwdWJsaWMgYXN5bmMgZ2FtZU1haW4oKSB7XG4gICAgLy8gUHJlcGFyZSBpbnRlcm5hbCBzdGF0ZVxuICAgIGNvbnN0IGNvbnN1bWVkVGltZXNOcyA9IFswLCAwXTtcbiAgICBsZXQgdHVybiA9IDA7XG4gICAgY29uc3Qgc2NvcmVzID0gWzAsIDBdO1xuICAgIGNvbnN0IGJvYXJkcyA9IFtcbiAgICAgIG5ldyBCb2FyZE1hbmFnZXIoR2FtZU1hbmFnZXIuQk9BUkRfTlVNX1JPV1MsIEdhbWVNYW5hZ2VyLkJPQVJEX05VTV9DT0xTKSxcbiAgICAgIG5ldyBCb2FyZE1hbmFnZXIoR2FtZU1hbmFnZXIuQk9BUkRfTlVNX1JPV1MsIEdhbWVNYW5hZ2VyLkJPQVJEX05VTV9DT0xTKSxcbiAgICBdO1xuXG4gICAgY29uc3QgYnVpbGRSZXN1bHQgPSAod2lubmVyOiBudW1iZXIsIHJlYXNvbjogR2FtZVJlc3VsdFJlYXNvbik6IEdhbWVSZXN1bHQgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd2lubmVyOiB3aW5uZXIgPT09IDAgPyAnRklSU1QnIDogJ1NFQ09ORCcsXG4gICAgICAgIHJlYXNvbixcbiAgICAgICAgdHVybixcbiAgICAgICAgc3RhdHM6IHtcbiAgICAgICAgICBmaXJzdDogeyB0aW1lOiBjb25zdW1lZFRpbWVzTnNbMF0sIHNjb3JlOiBzY29yZXNbMF0gfSxcbiAgICAgICAgICBzZWNvbmQ6IHsgdGltZTogY29uc3VtZWRUaW1lc05zWzFdLCBzY29yZTogc2NvcmVzWzFdIH0sXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH07XG5cbiAgICAvLyBJbml0aWFsaXplXG4gICAgZm9yIChsZXQgcGxheWVyID0gMDsgcGxheWVyIDwgMjsgcGxheWVyKyspIHtcbiAgICAgIGNvbnN0IHJ1bm5lciA9IHRoaXMucnVubmVyc1twbGF5ZXJdO1xuICAgICAgY29uc3QgaW5wdXQgPSB7IGNvbW1hbmRzOiBbcGxheWVyLnRvU3RyaW5nKDEwKV0gfTtcbiAgICAgIGNvbnN0IHJldCA9IGF3YWl0IHJ1bm5lci5zZW5kQW5kUmVjZWl2ZURhdGEoaW5wdXQsIEdhbWVNYW5hZ2VyLklOVElBTElaRV9USU1FX01TKTtcblxuICAgICAgY29uc29sZS5sb2cocmV0KTtcbiAgICAgIHRoaXMuaW9Mb2cucHVzaChbaW5wdXQsIHJldF0pO1xuXG4gICAgICBjb25zdW1lZFRpbWVzTnNbcGxheWVyXSArPSByZXQucnVudGltZU5zO1xuXG4gICAgICBpZiAocmV0LnZlcmRpY3QgIT09ICdPSycpIHtcbiAgICAgICAgaWYgKHJldC52ZXJkaWN0ID09PSAnVExFJykge1xuICAgICAgICAgIHJldHVybiBidWlsZFJlc3VsdCgocGxheWVyICsgMSkgJSAyLCAnVElNRV9MSU1JVF9FWENFRURFRCcpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRPRE8gcmV0dXJuIG1vcmUgZGV0YWlsZWQgcmVzdWx0LlxuICAgICAgICByZXR1cm4gYnVpbGRSZXN1bHQoKHBsYXllciArIDEpICUgMiwgJ1JVTlRJTUVfRVJST1InKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVhc29uID0gKCgpID0+IHtcbiAgICAgICAgaWYgKCFyZXQub3V0cHV0KSB7XG4gICAgICAgICAgcmV0dXJuICdQUkVTRU5UQVRJT05fRVJST1InO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGluaXRpYWxUaWxlID0gcmV0Lm91dHB1dC5zcGxpdCgnICcpO1xuICAgICAgICBpZiAoIWluaXRpYWxUaWxlLmV2ZXJ5KEdhbWVNYW5hZ2VyLmlzUG9zaXRpdmVJbnRlZ2VyKSkge1xuICAgICAgICAgIHJldHVybiAnUFJFU0VOVEFUSU9OX0VSUk9SJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IFtyb3csIGNvbF0gPSBpbml0aWFsVGlsZS5tYXAodiA9PiB7XG4gICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHYsIDEwKSAtIDE7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIWJvYXJkc1twbGF5ZXJdLmJvYXJkLndpdGhpbkJvdW5kcyh7IHJvdywgY29sIH0pKSB7XG4gICAgICAgICAgcmV0dXJuICdJTlZBTElEX1BPU0lUSU9OJztcbiAgICAgICAgfVxuICAgICAgICBib2FyZHNbKHBsYXllciArIDEpICUgMl0uYm9hcmQuaW5zZXJ0VGlsZShuZXcgVGlsZSh7IHJvdywgY29sIH0sIDIpKTtcblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0pKCk7XG5cbiAgICAgIGlmIChyZWFzb24pIHtcbiAgICAgICAgcmV0dXJuIGJ1aWxkUmVzdWx0KChwbGF5ZXIgKyAxKSAlIDIsIHJlYXNvbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gR2FtZSBCb2R5XG4gICAgZm9yICh0dXJuID0gMTsgdHVybiA8PSBHYW1lTWFuYWdlci5NQVhfVFVSTjsgdHVybisrKSB7XG4gICAgICBmb3IgKGxldCBwbGF5ZXIgPSAwOyBwbGF5ZXIgPCAyOyBwbGF5ZXIrKykge1xuICAgICAgICBjb25zdCBydW5uZXIgPSB0aGlzLnJ1bm5lcnNbcGxheWVyXTtcbiAgICAgICAgY29uc3QgbXlCb2FyZCA9IGJvYXJkc1twbGF5ZXJdO1xuICAgICAgICBjb25zdCBlbmVteUJvYXJkID0gYm9hcmRzWyhwbGF5ZXIgKyAxKSAlIDJdO1xuXG4gICAgICAgIC8vIENoZWNrIGlzIHRoZXJlIGFueSByb29tIHRvIG1vdmUuXG4gICAgICAgIGlmICghbXlCb2FyZC5tb3Zlc0F2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgcmV0dXJuIGJ1aWxkUmVzdWx0KChwbGF5ZXIgKyAxKSAlIDIsICdCT0FSRF9GSUxMRUQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlucHV0ID0geyBjb21tYW5kczogW215Qm9hcmQudG9TdHJpbmcoKSwgZW5lbXlCb2FyZC50b1N0cmluZygpXSB9O1xuICAgICAgICBjb25zdCByZXQgPSBhd2FpdCBydW5uZXIuc2VuZEFuZFJlY2VpdmVEYXRhKGlucHV0LCBHYW1lTWFuYWdlci5NQUlOX1RVUk5fVElNRV9NUyk7XG5cbiAgICAgICAgY29uc29sZS5sb2cocmV0KTtcbiAgICAgICAgdGhpcy5pb0xvZy5wdXNoKFtpbnB1dCwgcmV0XSk7XG5cbiAgICAgICAgY29uc3VtZWRUaW1lc05zW3BsYXllcl0gKz0gcmV0LnJ1bnRpbWVOcztcblxuICAgICAgICBpZiAocmV0LnZlcmRpY3QgIT09ICdPSycpIHtcbiAgICAgICAgICBpZiAocmV0LnZlcmRpY3QgPT09ICdUTEUnKSB7XG4gICAgICAgICAgICByZXR1cm4gYnVpbGRSZXN1bHQoKHBsYXllciArIDEpICUgMiwgJ1RJTUVfTElNSVRfRVhDRUVERUQnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGJ1aWxkUmVzdWx0KChwbGF5ZXIgKyAxKSAlIDIsICdSVU5USU1FX0VSUk9SJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBSZXR1cm4gVmFsdWVcbiAgICAgICAgY29uc3QgcmVhc29uID0gKCgpID0+IHtcbiAgICAgICAgICBpZiAoIXJldC5vdXRwdXQpIHtcbiAgICAgICAgICAgIHJldHVybiAnUFJFU0VOVEFUSU9OX0VSUk9SJztcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgW2NvbW1hbmQsIC4uLmF0dGFja10gPSByZXQub3V0cHV0LnNwbGl0KCcgJyk7XG4gICAgICAgICAgaWYgKCFjb21tYW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1BSRVNFTlRBVElPTl9FUlJPUic7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gTW92ZVxuICAgICAgICAgIGNvbnN0IGRpckNvbW1hbmQgPSBHYW1lTWFuYWdlci5ESVJFQ1RJT05TX01BUC5nZXQoY29tbWFuZCk7XG4gICAgICAgICAgaWYgKCFkaXJDb21tYW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0lOVkFMSURfRElSRUNUSU9OJztcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgbW92ZWRSZXN1bHQgPSBteUJvYXJkLm1vdmUoZGlyQ29tbWFuZCk7XG4gICAgICAgICAgaWYgKCFtb3ZlZFJlc3VsdC5tb3ZlZCkge1xuICAgICAgICAgICAgcmV0dXJuICdJTlZBTElEX0RJUkVDVElPTic7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gQXR0YWNrXG4gICAgICAgICAgY29uc3QgcGFyc2VkID0gR2FtZU1hbmFnZXIuUEFSU0VfQVRUQUNLX0NPTU1BTkQoYXR0YWNrLCBlbmVteUJvYXJkLmJvYXJkKTtcbiAgICAgICAgICBpZiAocGFyc2VkLnZlcmRpY3QgIT09ICdPSycpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBsZXQgdXNlZFZhbHVlID0gMDtcbiAgICAgICAgICBwYXJzZWQudGlsZXMuZm9yRWFjaCh0aWxlID0+IHtcbiAgICAgICAgICAgIGVuZW15Qm9hcmQuYm9hcmQuaW5zZXJ0VGlsZSh0aWxlKTtcbiAgICAgICAgICAgIHVzZWRWYWx1ZSArPSB0aWxlLnZhbHVlIHx8IDA7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAodXNlZFZhbHVlICE9PSBNYXRoLnBvdygyLCBtb3ZlZFJlc3VsdC5jb3VudE1lcmdlZCArIDEpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0lOVkFMSURfVkFMVUVfVE9fUFVUJztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzY29yZXNbcGxheWVyXSArPSBtb3ZlZFJlc3VsdC5zY29yZU9idGFpbmVkO1xuXG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0pKCk7XG5cbiAgICAgICAgaWYgKHJlYXNvbikge1xuICAgICAgICAgIHJldHVybiBidWlsZFJlc3VsdCgocGxheWVyICsgMSkgJSAyLCByZWFzb24pO1xuICAgICAgICB9XG4gICAgICB9IC8vIHBsYXllclxuICAgIH0gLy8gdHVyblxuXG4gICAgLy8gdmVyZGljdCBieSBzY29yZVxuICAgIGlmIChzY29yZXNbMF0gPiBzY29yZXNbMV0pIHtcbiAgICAgIHJldHVybiBidWlsZFJlc3VsdCgwLCAnU0NPUkUnKTtcbiAgICB9IGVsc2UgaWYgKHNjb3Jlc1sxXSA+IHNjb3Jlc1swXSkge1xuICAgICAgcmV0dXJuIGJ1aWxkUmVzdWx0KDEsICdTQ09SRScpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYnVpbGRSZXN1bHQoMSwgJ0VWRU5fU0NPUkUnKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgd3JpdGVMb2dzVG9GaWxlKGZpbGVOYW1lOiBzdHJpbmcpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuUlVOVElNRSA9PT0gJ25vZGUnKSB7XG4gICAgICBjb25zdCB3cml0ZXIgPSByZXF1aXJlKCdmcycpLmNyZWF0ZVdyaXRlU3RyZWFtKGZpbGVOYW1lKTsgLy8gdHNsaW50OmRpc2FibGUtbGluZSBuby1yZXF1aXJlLWltcG9ydHNcbiAgICAgIHdyaXRlci5zZXREZWZhdWx0RW5jb2RpbmcoJ3V0Zi04Jyk7XG4gICAgICBjb25zdCBsb2dMaXN0ID0gdGhpcy5pb0xvZy5tYXAoXG4gICAgICAgIChbaW5wdXQsIG91dHB1dF0sIHR1cm4pOiBUdXJuUmVjb3JkID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcGxheWVySW5kZXg6IHR1cm4gJSAyID09PSAwID8gMCA6IDEsXG4gICAgICAgICAgICBydW50aW1lOiBvdXRwdXQucnVudGltZU5zIC8gMTAwMCAvIDEwMDAgfHwgMCxcbiAgICAgICAgICAgIGFpaW5wdXQ6IGlucHV0LmNvbW1hbmRzLmpvaW4oJ1xcbicpLFxuICAgICAgICAgICAgYWlvdXRwdXQ6IG91dHB1dC5vdXRwdXQsXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHdyaXRlci53cml0ZShKU09OLnN0cmluZ2lmeShsb2dMaXN0KSk7XG4gICAgICB3cml0ZXIuZW5kKCk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBUaWxlIH0gZnJvbSAnLi4vLi4vZ2FtZS9zcmMvQ29yZS9UaWxlJztcbmltcG9ydCB7IFBvc2l0aW9uIH0gZnJvbSAnLi4vLi4vZ2FtZS9zcmMvQ29yZS90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBIVE1MQWN0dWF0b3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IHRpbGVDb250YWluZXI6IEhUTUxFbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKHRpbGVDb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG4gICAgdGhpcy50aWxlQ29udGFpbmVyID0gdGlsZUNvbnRhaW5lcjtcbiAgfVxuXG4gIHB1YmxpYyBhY3R1YXRlKGdyaWQ6IFRpbGVbXVtdKSB7XG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICB0aGlzLmNsZWFyQ29udGFpbmVyKHRoaXMudGlsZUNvbnRhaW5lcik7XG5cbiAgICAgIGdyaWQuZm9yRWFjaChjb2x1bW4gPT4ge1xuICAgICAgICBjb2x1bW4uZm9yRWFjaChjZWxsID0+IHtcbiAgICAgICAgICBpZiAoY2VsbCkge1xuICAgICAgICAgICAgdGhpcy5hZGRUaWxlKGNlbGwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBjbGVhckNvbnRhaW5lcihjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG4gICAgd2hpbGUgKGNvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQoY29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhZGRUaWxlKHRpbGU6IFRpbGUpIHtcbiAgICBpZiAoIXRpbGUudmFsdWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgaW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBwb3NpdGlvbiA9IHRpbGUucHJldmlvdXNQb3NpdGlvbiB8fCB7IHJvdzogdGlsZS5yb3csIGNvbDogdGlsZS5jb2wgfTtcbiAgICBjb25zdCBwb3NpdGlvbkNsYXNzID0gdGhpcy5wb3NpdGlvbkNsYXNzKHBvc2l0aW9uKTtcblxuICAgIC8vIFdlIGNhbid0IHVzZSBjbGFzc2xpc3QgYmVjYXVzZSBpdCBzb21laG93IGdsaXRjaGVzIHdoZW4gcmVwbGFjaW5nIGNsYXNzZXNcbiAgICBjb25zdCBjbGFzc2VzID0gWyd0aWxlJywgYHRpbGUtJHt0aWxlLnZhbHVlfWAsIHBvc2l0aW9uQ2xhc3NdO1xuXG4gICAgaWYgKHRpbGUudmFsdWUgPiAyMDQ4KSB7XG4gICAgICBjbGFzc2VzLnB1c2goJ3RpbGUtc3VwZXInKTtcbiAgICB9XG5cbiAgICB0aGlzLmFwcGx5Q2xhc3Nlcyh3cmFwcGVyLCBjbGFzc2VzKTtcblxuICAgIGlubmVyLmNsYXNzTGlzdC5hZGQoJ3RpbGUtaW5uZXInKTtcbiAgICBpbm5lci50ZXh0Q29udGVudCA9IHRpbGUudmFsdWUudG9TdHJpbmcoMTApO1xuXG4gICAgaWYgKHRpbGUucHJldmlvdXNQb3NpdGlvbikge1xuICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdGhlIHRpbGUgZ2V0cyByZW5kZXJlZCBpbiB0aGUgcHJldmlvdXMgcG9zaXRpb24gZmlyc3RcbiAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICBjbGFzc2VzWzJdID0gdGhpcy5wb3NpdGlvbkNsYXNzKHsgcm93OiB0aWxlLnJvdywgY29sOiB0aWxlLmNvbCB9KTtcbiAgICAgICAgdGhpcy5hcHBseUNsYXNzZXMod3JhcHBlciwgY2xhc3Nlcyk7IC8vIFVwZGF0ZSB0aGUgcG9zaXRpb25cbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAodGlsZS5tZXJnZWRGcm9tKSB7XG4gICAgICBjbGFzc2VzLnB1c2goJ3RpbGUtbWVyZ2VkJyk7XG4gICAgICB0aGlzLmFwcGx5Q2xhc3Nlcyh3cmFwcGVyLCBjbGFzc2VzKTtcblxuICAgICAgLy8gUmVuZGVyIHRoZSB0aWxlcyB0aGF0IG1lcmdlZFxuICAgICAgdGlsZS5tZXJnZWRGcm9tLmZvckVhY2gobWVyZ2VkID0+IHtcbiAgICAgICAgdGhpcy5hZGRUaWxlKG1lcmdlZCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2xhc3Nlcy5wdXNoKCd0aWxlLW5ldycpO1xuICAgICAgdGhpcy5hcHBseUNsYXNzZXMod3JhcHBlciwgY2xhc3Nlcyk7XG4gICAgfVxuXG4gICAgLy8gQWRkIHRoZSBpbm5lciBwYXJ0IG9mIHRoZSB0aWxlIHRvIHRoZSB3cmFwcGVyXG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZChpbm5lcik7XG5cbiAgICAvLyBQdXQgdGhlIHRpbGUgb24gdGhlIGJvYXJkXG4gICAgdGhpcy50aWxlQ29udGFpbmVyLmFwcGVuZENoaWxkKHdyYXBwZXIpO1xuICB9XG5cbiAgcHJpdmF0ZSBwb3NpdGlvbkNsYXNzKHBvc2l0aW9uOiBQb3NpdGlvbikge1xuICAgIHJldHVybiBgdGlsZS1wb3NpdGlvbi0ke3Bvc2l0aW9uLmNvbCArIDF9LSR7cG9zaXRpb24ucm93ICsgMX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBhcHBseUNsYXNzZXMoZWxlbWVudDogSFRNTEVsZW1lbnQsIGNsYXNzZXM6IHN0cmluZ1tdKSB7XG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgY2xhc3Nlcy5qb2luKCcgJykpO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9